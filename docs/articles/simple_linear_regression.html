<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>simple_linear_regression • rTorch</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="simple_linear_regression">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rTorch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.9012</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple_linear_regression.html">Simple Linear Regression</a>
    </li>
    <li>
      <a href="../articles/linear_regression_rainfall.html">Linear Regregression, rainfall</a>
    </li>
    <li>
      <a href="../articles/linear_regression_rainfall_builtins.html">Linear Regregression, rainfall. PyTorch builtins</a>
    </li>
    <li>
      <a href="../articles/two_layer_neural_network.html">Two Layer Neural Network</a>
    </li>
    <li>
      <a href="../articles/logistic_regression_mnist_digits_idx.html">Logistic Regression, MNIST digits</a>
    </li>
    <li>
      <a href="../articles/idx_images_minist_digits.html">MNIST digits recognition, IDX format</a>
    </li>
    <li>
      <a href="../articles/png_images_mnist_digits.html">MNIST digits recognition, PNG images</a>
    </li>
    <li>
      <a href="../articles/mnist_fashion_inference.html">MNIST Fashion images. Inference and Validation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/f0nzie/rTorch">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>simple_linear_regression</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/f0nzie/rTorch/blob/master/vignettes/simple_linear_regression.Rmd"><code>vignettes/simple_linear_regression.Rmd</code></a></small>
      <div class="hidden name"><code>simple_linear_regression.Rmd</code></div>

    </div>

    
    
<p>Source: <a href="https://www.guru99.com/pytorch-tutorial.html" class="uri">https://www.guru99.com/pytorch-tutorial.html</a></p>
<div id="creating-the-network-model" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-the-network-model" class="anchor"></a>Creating the network model</h2>
<p>Our network model is a simple Linear layer with an input and an output shape of one.</p>
<p>And the network output should be like this</p>
<pre><code>Net(
  (hidden): Linear(in_features=1, out_features=1, bias=True)
)</code></pre>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rTorch)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">nn       &lt;-<span class="st"> </span>torch<span class="op">$</span>nn</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">Variable &lt;-<span class="st"> </span>torch<span class="op">$</span>autograd<span class="op">$</span>Variable</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">torch<span class="op">$</span><span class="kw">manual_seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; &lt;torch._C.Generator&gt;</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/py_run">py_run_string</a></span>(<span class="st">"import torch"</span>)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">main =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/py_run">py_run_string</a></span>(</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="st">"</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="st">import torch.nn as nn</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="st">class Net(nn.Module):</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="st">   def __init__(self):</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="st">       super(Net, self).__init__()</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="st">       self.layer = torch.nn.Linear(1, 1)</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="st">   def forward(self, x):</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="st">       x = self.layer(x)      </span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="st">       return x</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="st">"</span>)</a>
<a class="sourceLine" id="cb2-23" data-line-number="23"></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co"># build a Linear Rgression model</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26">net &lt;-<span class="st"> </span>main<span class="op">$</span><span class="kw">Net</span>()</a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(net)</a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt; Net(</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt;   (layer): Linear(in_features=1, out_features=1, bias=True)</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt; )</span></a></code></pre></div>
</div>
<div id="datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#datasets" class="anchor"></a>Datasets</h2>
<p>Before you start the training process, you need to know our data. You make a random function to test our model. <span class="math inline">\(Y = x3 sin(x)+ 3x+0.8 rand(100)\)</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">np<span class="op">$</span>random<span class="op">$</span><span class="kw">seed</span>(123L)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">x =<span class="st"> </span>np<span class="op">$</span>random<span class="op">$</span><span class="kw">rand</span>(100L)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">y =<span class="st"> </span>np<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sin</a></span>(x) <span class="op">*</span><span class="st"> </span>np<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/power">power</a></span>(x, 3L) <span class="op">+</span><span class="st"> </span>3L <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>np<span class="op">$</span>random<span class="op">$</span><span class="kw">rand</span>(100L) <span class="op">*</span><span class="st"> </span><span class="fl">0.8</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(x, y)</a></code></pre></div>
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-3-1.png" width="528"></p>
<p>Before you start the training process, you need to convert the numpy array to Variables that supported by Torch and autograd.</p>
<div id="converting-from-numpy-to-tensor" class="section level3">
<h3 class="hasAnchor">
<a href="#converting-from-numpy-to-tensor" class="anchor"></a>Converting from numpy to tensor</h3>
<p>Notice that before converting to a Torch tensor, we need first to convert the R numeric vector to a <code>numpy</code> array:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># convert numpy array to tensor in shape of input size</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/r-py-conversion">r_to_py</a></span>(x)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/r-py-conversion">r_to_py</a></span>(y)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">x =<span class="st"> </span>torch<span class="op">$</span><span class="kw">from_numpy</span>(x<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/reshape">reshape</a></span>(<span class="op">-</span>1L, 1L))<span class="op">$</span><span class="kw">float</span>()</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">y =<span class="st"> </span>torch<span class="op">$</span><span class="kw">from_numpy</span>(y<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/reshape">reshape</a></span>(<span class="op">-</span>1L, 1L))<span class="op">$</span><span class="kw">float</span>()</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(x, y)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; tensor([[0.6965],</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;         [0.2861],</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;         [0.2269],</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;         [0.5513],</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;         [0.7195],</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;         [0.4231],</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;         [0.9808],</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;         [0.6848],</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt;         [0.4809],</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt;         [0.3921],</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;         [0.3432],</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;         [0.7290],</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt;         [0.4386],</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;         [0.0597],</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt;         [0.3980],</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt;         [0.7380],</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt;         [0.1825],</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt;         [0.1755],</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt;         [0.5316],</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt;         [0.5318],</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt;         [0.6344],</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt;         [0.8494],</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt;         [0.7245],</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt;         [0.6110],</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt;         [0.7224],</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt;         [0.3230],</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt;         [0.3618],</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">#&gt;         [0.2283],</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt;         [0.2937],</span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="co">#&gt;         [0.6310],</span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co">#&gt;         [0.0921],</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="co">#&gt;         [0.4337],</span></a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="co">#&gt;         [0.4309],</span></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"><span class="co">#&gt;         [0.4937],</span></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"><span class="co">#&gt;         [0.4258],</span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="co">#&gt;         [0.3123],</span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="co">#&gt;         [0.4264],</span></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="co">#&gt;         [0.8934],</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45"><span class="co">#&gt;         [0.9442],</span></a>
<a class="sourceLine" id="cb4-46" data-line-number="46"><span class="co">#&gt;         [0.5018],</span></a>
<a class="sourceLine" id="cb4-47" data-line-number="47"><span class="co">#&gt;         [0.6240],</span></a>
<a class="sourceLine" id="cb4-48" data-line-number="48"><span class="co">#&gt;         [0.1156],</span></a>
<a class="sourceLine" id="cb4-49" data-line-number="49"><span class="co">#&gt;         [0.3173],</span></a>
<a class="sourceLine" id="cb4-50" data-line-number="50"><span class="co">#&gt;         [0.4148],</span></a>
<a class="sourceLine" id="cb4-51" data-line-number="51"><span class="co">#&gt;         [0.8663],</span></a>
<a class="sourceLine" id="cb4-52" data-line-number="52"><span class="co">#&gt;         [0.2505],</span></a>
<a class="sourceLine" id="cb4-53" data-line-number="53"><span class="co">#&gt;         [0.4830],</span></a>
<a class="sourceLine" id="cb4-54" data-line-number="54"><span class="co">#&gt;         [0.9856],</span></a>
<a class="sourceLine" id="cb4-55" data-line-number="55"><span class="co">#&gt;         [0.5195],</span></a>
<a class="sourceLine" id="cb4-56" data-line-number="56"><span class="co">#&gt;         [0.6129],</span></a>
<a class="sourceLine" id="cb4-57" data-line-number="57"><span class="co">#&gt;         [0.1206],</span></a>
<a class="sourceLine" id="cb4-58" data-line-number="58"><span class="co">#&gt;         [0.8263],</span></a>
<a class="sourceLine" id="cb4-59" data-line-number="59"><span class="co">#&gt;         [0.6031],</span></a>
<a class="sourceLine" id="cb4-60" data-line-number="60"><span class="co">#&gt;         [0.5451],</span></a>
<a class="sourceLine" id="cb4-61" data-line-number="61"><span class="co">#&gt;         [0.3428],</span></a>
<a class="sourceLine" id="cb4-62" data-line-number="62"><span class="co">#&gt;         [0.3041],</span></a>
<a class="sourceLine" id="cb4-63" data-line-number="63"><span class="co">#&gt;         [0.4170],</span></a>
<a class="sourceLine" id="cb4-64" data-line-number="64"><span class="co">#&gt;         [0.6813],</span></a>
<a class="sourceLine" id="cb4-65" data-line-number="65"><span class="co">#&gt;         [0.8755],</span></a>
<a class="sourceLine" id="cb4-66" data-line-number="66"><span class="co">#&gt;         [0.5104],</span></a>
<a class="sourceLine" id="cb4-67" data-line-number="67"><span class="co">#&gt;         [0.6693],</span></a>
<a class="sourceLine" id="cb4-68" data-line-number="68"><span class="co">#&gt;         [0.5859],</span></a>
<a class="sourceLine" id="cb4-69" data-line-number="69"><span class="co">#&gt;         [0.6249],</span></a>
<a class="sourceLine" id="cb4-70" data-line-number="70"><span class="co">#&gt;         [0.6747],</span></a>
<a class="sourceLine" id="cb4-71" data-line-number="71"><span class="co">#&gt;         [0.8423],</span></a>
<a class="sourceLine" id="cb4-72" data-line-number="72"><span class="co">#&gt;         [0.0832],</span></a>
<a class="sourceLine" id="cb4-73" data-line-number="73"><span class="co">#&gt;         [0.7637],</span></a>
<a class="sourceLine" id="cb4-74" data-line-number="74"><span class="co">#&gt;         [0.2437],</span></a>
<a class="sourceLine" id="cb4-75" data-line-number="75"><span class="co">#&gt;         [0.1942],</span></a>
<a class="sourceLine" id="cb4-76" data-line-number="76"><span class="co">#&gt;         [0.5725],</span></a>
<a class="sourceLine" id="cb4-77" data-line-number="77"><span class="co">#&gt;         [0.0957],</span></a>
<a class="sourceLine" id="cb4-78" data-line-number="78"><span class="co">#&gt;         [0.8853],</span></a>
<a class="sourceLine" id="cb4-79" data-line-number="79"><span class="co">#&gt;         [0.6272],</span></a>
<a class="sourceLine" id="cb4-80" data-line-number="80"><span class="co">#&gt;         [0.7234],</span></a>
<a class="sourceLine" id="cb4-81" data-line-number="81"><span class="co">#&gt;         [0.0161],</span></a>
<a class="sourceLine" id="cb4-82" data-line-number="82"><span class="co">#&gt;         [0.5944],</span></a>
<a class="sourceLine" id="cb4-83" data-line-number="83"><span class="co">#&gt;         [0.5568],</span></a>
<a class="sourceLine" id="cb4-84" data-line-number="84"><span class="co">#&gt;         [0.1590],</span></a>
<a class="sourceLine" id="cb4-85" data-line-number="85"><span class="co">#&gt;         [0.1531],</span></a>
<a class="sourceLine" id="cb4-86" data-line-number="86"><span class="co">#&gt;         [0.6955],</span></a>
<a class="sourceLine" id="cb4-87" data-line-number="87"><span class="co">#&gt;         [0.3188],</span></a>
<a class="sourceLine" id="cb4-88" data-line-number="88"><span class="co">#&gt;         [0.6920],</span></a>
<a class="sourceLine" id="cb4-89" data-line-number="89"><span class="co">#&gt;         [0.5544],</span></a>
<a class="sourceLine" id="cb4-90" data-line-number="90"><span class="co">#&gt;         [0.3890],</span></a>
<a class="sourceLine" id="cb4-91" data-line-number="91"><span class="co">#&gt;         [0.9251],</span></a>
<a class="sourceLine" id="cb4-92" data-line-number="92"><span class="co">#&gt;         [0.8417],</span></a>
<a class="sourceLine" id="cb4-93" data-line-number="93"><span class="co">#&gt;         [0.3574],</span></a>
<a class="sourceLine" id="cb4-94" data-line-number="94"><span class="co">#&gt;         [0.0436],</span></a>
<a class="sourceLine" id="cb4-95" data-line-number="95"><span class="co">#&gt;         [0.3048],</span></a>
<a class="sourceLine" id="cb4-96" data-line-number="96"><span class="co">#&gt;         [0.3982],</span></a>
<a class="sourceLine" id="cb4-97" data-line-number="97"><span class="co">#&gt;         [0.7050],</span></a>
<a class="sourceLine" id="cb4-98" data-line-number="98"><span class="co">#&gt;         [0.9954],</span></a>
<a class="sourceLine" id="cb4-99" data-line-number="99"><span class="co">#&gt;         [0.3559],</span></a>
<a class="sourceLine" id="cb4-100" data-line-number="100"><span class="co">#&gt;         [0.7625],</span></a>
<a class="sourceLine" id="cb4-101" data-line-number="101"><span class="co">#&gt;         [0.5932],</span></a>
<a class="sourceLine" id="cb4-102" data-line-number="102"><span class="co">#&gt;         [0.6917],</span></a>
<a class="sourceLine" id="cb4-103" data-line-number="103"><span class="co">#&gt;         [0.1511],</span></a>
<a class="sourceLine" id="cb4-104" data-line-number="104"><span class="co">#&gt;         [0.3989],</span></a>
<a class="sourceLine" id="cb4-105" data-line-number="105"><span class="co">#&gt;         [0.2409],</span></a>
<a class="sourceLine" id="cb4-106" data-line-number="106"><span class="co">#&gt;         [0.3435]])</span></a></code></pre></div>
</div>
</div>
<div id="optimizer-and-loss" class="section level2">
<h2 class="hasAnchor">
<a href="#optimizer-and-loss" class="anchor"></a>Optimizer and Loss</h2>
<p>Next, you should define the Optimizer and the Loss Function for our training process.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Define Optimizer and Loss Function</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">optimizer &lt;-<span class="st"> </span>torch<span class="op">$</span>optim<span class="op">$</span><span class="kw">SGD</span>(net<span class="op">$</span><span class="kw">parameters</span>(), <span class="dt">lr=</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">loss_func &lt;-<span class="st"> </span>torch<span class="op">$</span>nn<span class="op">$</span><span class="kw">MSELoss</span>()</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(optimizer)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; SGD (</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; Parameter Group 0</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;     dampening: 0</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;     lr: 0.2</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt;     momentum: 0</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;     nesterov: False</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;     weight_decay: 0</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(loss_func)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; MSELoss()</span></a></code></pre></div>
</div>
<div id="training" class="section level2">
<h2 class="hasAnchor">
<a href="#training" class="anchor"></a>Training</h2>
<p>Now let’s start our training process. With an epoch of 250, you will iterate our data to find the best value for our hyperparameters.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># x = x$type(torch$float)   # make it a a FloatTensor</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># y = y$type(torch$float)</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># x &lt;- torch$as_tensor(x, dtype = torch$float)</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co"># y &lt;- torch$as_tensor(y, dtype = torch$float)</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">inputs  =<span class="st"> </span><span class="kw">Variable</span>(x)</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">outputs =<span class="st"> </span><span class="kw">Variable</span>(y)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co"># base plot</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(x<span class="op">$</span>data<span class="op">$</span><span class="kw">numpy</span>(), y<span class="op">$</span>data<span class="op">$</span><span class="kw">numpy</span>(), <span class="dt">col =</span> <span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="simple_linear_regression_files/figure-html/unnamed-chunk-6-1.png" width="528"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">250</span>) {</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">   prediction =<span class="st"> </span><span class="kw">net</span>(inputs)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">   loss =<span class="st"> </span><span class="kw">loss_func</span>(prediction, outputs)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">   optimizer<span class="op">$</span><span class="kw">zero_grad</span>()</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">   loss<span class="op">$</span><span class="kw">backward</span>()</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">   optimizer<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/step">step</a></span>()</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">   </a>
<a class="sourceLine" id="cb7-8" data-line-number="8">   <span class="cf">if</span> (i <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) <span class="cf">break</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">   <span class="cf">if</span> (i <span class="op">%%</span><span class="st"> </span><span class="dv">10</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">       <span class="co"># plot and show learning process</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">      <span class="co"># points(x$data$numpy(), y$data$numpy())</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13">      <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/points">points</a></span>(x<span class="op">$</span>data<span class="op">$</span><span class="kw">numpy</span>(), prediction<span class="op">$</span>data<span class="op">$</span><span class="kw">numpy</span>(), <span class="dt">col=</span><span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb7-14" data-line-number="14">       <span class="co"># cat(i, loss$data$numpy(), "\n")</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15">   }</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">}</a></code></pre></div>
</div>
<div id="result" class="section level2">
<h2 class="hasAnchor">
<a href="#result" class="anchor"></a>Result</h2>
<p>As you can see below, you successfully performed regression with a neural network. Actually, on every iteration, the red line in the plot will update and change its position to fit the data. But in this picture, you only show you the final result.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#creating-the-network-model">Creating the network model</a></li>
      <li><a href="#datasets">Datasets</a></li>
      <li><a href="#optimizer-and-loss">Optimizer and Loss</a></li>
      <li><a href="#training">Training</a></li>
      <li><a href="#result">Result</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Alfonso R. Reyes.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
