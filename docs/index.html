<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R Bindings to PyTorch â€¢ rTorch</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="R Bindings to PyTorch">
<meta property="og:description" content="R implementation and interface of the Machine Learning platform 
    PyTorch &lt;https://pytorch.org/&gt; developed in Python. It requires a conda
    environment with torch and torchvision Python packages to provide 
    PyTorch functions, methods and classes. The key object in PyTorch is the 
    tensor which is in essence a multidimensional array. These tensors are fairly 
    flexible in performing calculations in CPUs as well as GPUs to accelerate 
    tensor operations.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">rTorch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/installation.html">Installation</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/f0nzie/rTorch/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="rtorch" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#rtorch" class="anchor"></a>rTorch</h1></div>
<p>The goal of <code>rTorch</code> is providing an R wrapper to <a href="https://pytorch.org/">PyTorch</a>. <code>rTorch</code> provides all the functionality of PyTorch plus all the features that R provides. We have borrowed some ideas and code used in R <a href="https://github.com/rstudio/tensorflow">tensorflow</a> to implement <code>rTorch</code>.</p>
<p>Besides the module <code>torch</code>, which directly provides <code>PyTorch</code> methods, classes and functions, the package also provides the modules <code>numpy</code> as a method called <code>np</code>, and <code>torchvision</code>, as well. The dollar sign <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> after the module will provide you access to all their sub-objects. Example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="va">tv</span> <span class="op">&lt;-</span> <span class="fu">rTorch</span><span class="fu">::</span><span class="va"><a href="reference/torch.html">torchvision</a></span>
<span class="va">tv</span>
<span class="co">#&gt; Module(torchvision)</span>

<span class="va">np</span> <span class="op">&lt;-</span> <span class="fu">rTorch</span><span class="fu">::</span><span class="va"><a href="reference/torch.html">np</a></span>
<span class="va">np</span>
<span class="co">#&gt; Module(numpy)</span>

<span class="va">torch_module</span> <span class="op">&lt;-</span> <span class="fu">rTorch</span><span class="fu">::</span><span class="va"><a href="reference/torch.html">torch</a></span>
<span class="va">torch_module</span>
<span class="co">#&gt; Module(torch)</span></pre></div>
<div id="rtorch-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#rtorch-examples" class="anchor"></a>rTorch Examples</h2>
<p>To lighten up the time in building this <code>rTorch</code> package, we moved the examples that use <em>tensor operations</em> and <em>neural networks</em> to separate repositories. There are two sets of examples:</p>
<ul>
<li>
<em>The rTorch Minimal Book</em> at <a href="https://f0nzie.github.io/rtorch-minimal-book/" class="uri">https://f0nzie.github.io/rtorch-minimal-book/</a>
</li>
<li>
<em>rTorch Advanced Examples</em> at <a href="https://github.com/f0nzie/rTorch.examples" class="uri">https://github.com/f0nzie/rTorch.examples</a>
</li>
</ul>
</div>
<div id="rtorch-installation" class="section level2">
<h2 class="hasAnchor">
<a href="#rtorch-installation" class="anchor"></a>rTorch installation</h2>
<p><code>rTorch</code> is available via CRAN and from GitHub.</p>
<div id="from-cran" class="section level3">
<h3 class="hasAnchor">
<a href="#from-cran" class="anchor"></a>From CRAN</h3>
<p>Install from CRAN using <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("rTorch")</a></code> from the R console, or from <em>RStudio</em> using <code>Tools</code>, <code>Install Packages</code> from the menu.</p>
</div>
<div id="from-github" class="section level3">
<h3 class="hasAnchor">
<a href="#from-github" class="anchor"></a>From GitHub</h3>
<p>For the latest version install from GitHub. Install <code>rTorch</code> with:</p>
<p><code><a href="https://devtools.r-lib.org//reference/remote-reexports.html">devtools::install_github("f0nzie/rTorch")</a></code></p>
<p>Installing from GitHub gives you the flexibility of experimenting with the latest development version of <code>rTorch</code>. For instance, to install <code>rTorch</code> from the <code>develop</code> branch:</p>
<p><code><a href="https://devtools.r-lib.org//reference/remote-reexports.html">devtools::install_github("f0nzie/rTorch", ref="develop")</a></code></p>
<p>or clone with Git with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>git clone https<span class="op">:</span><span class="er">//</span>github.com<span class="op">/</span>f0nzie<span class="op">/</span>rTorch.git</span></code></pre></div>
</div>
</div>
</div>
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting Started</h1>
<div id="tensor-types" class="section level2">
<h2 class="hasAnchor">
<a href="#tensor-types" class="anchor"></a>Tensor types</h2>
<p>There are five major type of Tensors in PyTorch: * Byte * Float * Double * Long * Bool</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/f0nzie/rTorch">rTorch</a></span><span class="op">)</span>

<span class="va">byte_tensor</span>   <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ByteTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span>
<span class="va">float_tensor</span>  <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span>
<span class="va">double_tensor</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">DoubleTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span>
<span class="va">long_tensor</span>   <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">LongTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span>
<span class="va">bool_tensor</span>   <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">BoolTensor</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">5L</span><span class="op">)</span>

<span class="va">byte_tensor</span>  
<span class="co">#&gt; tensor([[58,  0,  0],</span>
<span class="co">#&gt;         [ 0,  0,  0],</span>
<span class="co">#&gt;         [ 0,  0,  0]], dtype=torch.uint8)</span>
<span class="va">float_tensor</span>  
<span class="co">#&gt; tensor([[0., 0., 0.],</span>
<span class="co">#&gt;         [0., 0., 0.],</span>
<span class="co">#&gt;         [0., 0., 0.]])</span>
<span class="va">double_tensor</span> 
<span class="co">#&gt; tensor([[6.9259e-310, 6.9259e-310, 1.2095e-312],</span>
<span class="co">#&gt;         [1.2697e-321, 6.9259e-310, 4.6888e-310],</span>
<span class="co">#&gt;         [ 0.0000e+00,  0.0000e+00,  0.0000e+00]], dtype=torch.float64)</span>
<span class="va">long_tensor</span>   
<span class="co">#&gt; tensor([[140182629985840, 140182629985840,               0],</span>
<span class="co">#&gt;         [ 94902887985680,               0,               0],</span>
<span class="co">#&gt;         [              0,               0,               0]])</span>
<span class="va">bool_tensor</span>   
<span class="co">#&gt; tensor([[False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False]])</span></pre></div>
<p>A <code>4D</code> tensor like in MNIST hand-written digits recognition dataset:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">mnist_4d</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">60000L</span>, <span class="fl">3L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span>

<span class="co"># size</span>
<span class="va">mnist_4d</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([60000, 3, 28, 28])</span>

<span class="co"># length</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mnist_4d</span><span class="op">)</span>
<span class="co">#&gt; [1] 141120000</span>

<span class="co"># shape, like in numpy</span>
<span class="va">mnist_4d</span><span class="op">$</span><span class="va">shape</span>
<span class="co">#&gt; torch.Size([60000, 3, 28, 28])</span>

<span class="co"># number of elements</span>
<span class="va">mnist_4d</span><span class="op">$</span><span class="fu">numel</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] 141120000</span></pre></div>
<p>A <code>3D</code> tensor:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">ft3d</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">3L</span>, <span class="fl">2L</span><span class="op">)</span>
<span class="va">ft3d</span>
<span class="co">#&gt; tensor([[[0., 0.],</span>
<span class="co">#&gt;          [0., 0.],</span>
<span class="co">#&gt;          [0., 0.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[0., 0.],</span>
<span class="co">#&gt;          [0., 0.],</span>
<span class="co">#&gt;          [0., 0.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[0., 0.],</span>
<span class="co">#&gt;          [0., 0.],</span>
<span class="co">#&gt;          [0., 0.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[0., 0.],</span>
<span class="co">#&gt;          [0., 0.],</span>
<span class="co">#&gt;          [0., 0.]]])</span></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co"># get first element in a tensor</span>
<span class="va">ft3d</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; tensor(0.)</span></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="co"># create a tensor with a value</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">full</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span>, <span class="fl">3.141592</span><span class="op">)</span>
<span class="co">#&gt; tensor([[3.1416, 3.1416, 3.1416],</span>
<span class="co">#&gt;         [3.1416, 3.1416, 3.1416]])</span></pre></div>
</div>
<div id="basic-tensor-operations" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-tensor-operations" class="anchor"></a>Basic Tensor Operations</h2>
<div id="add-tensors" class="section level3">
<h3 class="hasAnchor">
<a href="#add-tensors" class="anchor"></a>Add tensors</h3>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="co"># 3x5 matrix uniformly distributed between 0 and 1</span>
<span class="va">mat0</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">$</span><span class="fu">uniform_</span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">1L</span><span class="op">)</span>

<span class="co"># fill a 3x5 matrix with 0.1</span>
<span class="va">mat1</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">$</span><span class="fu">uniform_</span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>

<span class="co"># a vector with all ones</span>
<span class="va">mat2</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">5L</span><span class="op">)</span><span class="op">$</span><span class="fu">uniform_</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="co"># add two tensors</span>
<span class="va">mat0</span> <span class="op">+</span> <span class="va">mat1</span>
<span class="co">#&gt; tensor([[1.0472, 0.3601, 0.8105, 0.2573, 0.9311],</span>
<span class="co">#&gt;         [0.8394, 0.1631, 0.5836, 0.2908, 0.1806],</span>
<span class="co">#&gt;         [1.0795, 0.7679, 0.7024, 0.1542, 1.0788]])</span></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="co"># add three tensors</span>
<span class="va">mat0</span> <span class="op">+</span> <span class="va">mat1</span> <span class="op">+</span> <span class="va">mat2</span>
<span class="co">#&gt; tensor([[2.0472, 1.3601, 1.8105, 1.2573, 1.9311],</span>
<span class="co">#&gt;         [1.8394, 1.1631, 1.5836, 1.2908, 1.1806],</span>
<span class="co">#&gt;         [2.0795, 1.7679, 1.7024, 1.1542, 2.0788]])</span></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="co"># PyTorch add two tensors using add() function</span>
<span class="va">x</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">4L</span><span class="op">)</span>
<span class="va">y</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">4L</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[1.3989, 1.0835, 0.5394, 1.1483],</span>
<span class="co">#&gt;         [1.3036, 0.3943, 1.2853, 1.2172],</span>
<span class="co">#&gt;         [1.0630, 1.6868, 1.1131, 1.5882],</span>
<span class="co">#&gt;         [0.5632, 0.6763, 1.1735, 1.5093],</span>
<span class="co">#&gt;         [1.5244, 0.9094, 1.4205, 0.5644]])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; tensor([[1.3989, 1.0835, 0.5394, 1.1483],</span>
<span class="co">#&gt;         [1.3036, 0.3943, 1.2853, 1.2172],</span>
<span class="co">#&gt;         [1.0630, 1.6868, 1.1131, 1.5882],</span>
<span class="co">#&gt;         [0.5632, 0.6763, 1.1735, 1.5093],</span>
<span class="co">#&gt;         [1.5244, 0.9094, 1.4205, 0.5644]])</span></pre></div>
</div>
<div id="add-a-tensor-element-to-another-tensor" class="section level3">
<h3 class="hasAnchor">
<a href="#add-a-tensor-element-to-another-tensor" class="anchor"></a>Add a tensor element to another tensor</h3>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="co"># add an element of a tensor to another tensor</span>
<span class="va">mat1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">mat2</span>
<span class="co">#&gt; tensor([1.1000, 1.1000, 1.1000, 1.1000, 1.1000])</span></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="va">mat1</span>
<span class="co">#&gt; tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1000],</span>
<span class="co">#&gt;         [0.1000, 0.1000, 0.1000, 0.1000, 0.1000],</span>
<span class="co">#&gt;         [0.1000, 0.1000, 0.1000, 0.1000, 0.1000]])</span></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="co"># extract part of the tensor</span>
<span class="va">indices</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">index_select</span><span class="op">(</span><span class="va">mat1</span>, <span class="fl">1L</span>, <span class="va">indices</span><span class="op">)</span>   <span class="co"># rows = 0; columns = 1</span>
<span class="co">#&gt; tensor([[0.1000, 0.1000],</span>
<span class="co">#&gt;         [0.1000, 0.1000],</span>
<span class="co">#&gt;         [0.1000, 0.1000]])</span></pre></div>
</div>
<div id="add-a-scalar-to-a-tensor" class="section level3">
<h3 class="hasAnchor">
<a href="#add-a-scalar-to-a-tensor" class="anchor"></a>Add a scalar to a tensor</h3>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="co"># add a scalar to a tensor</span>
<span class="va">mat0</span> <span class="op">+</span> <span class="fl">0.1</span>
<span class="co">#&gt; tensor([[1.0472, 0.3601, 0.8105, 0.2573, 0.9311],</span>
<span class="co">#&gt;         [0.8394, 0.1631, 0.5836, 0.2908, 0.1806],</span>
<span class="co">#&gt;         [1.0795, 0.7679, 0.7024, 0.1542, 1.0788]])</span></pre></div>
</div>
<div id="multiply-a-tensor-by-a-scalar" class="section level3">
<h3 class="hasAnchor">
<a href="#multiply-a-tensor-by-a-scalar" class="anchor"></a>Multiply a tensor by a scalar</h3>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="co"># Multiply tensor by scalar</span>
<span class="va">tensor</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">4L</span>, dtype<span class="op">=</span><span class="va">torch</span><span class="op">$</span><span class="va">float64</span><span class="op">)</span>
<span class="va">scalar</span> <span class="op">=</span> <span class="va">np</span><span class="op">$</span><span class="fu">float64</span><span class="op">(</span><span class="fl">4.321</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"a numpy scalar: "</span>, <span class="va">scalar</span><span class="op">)</span>
<span class="co">#&gt; a numpy scalar: 4.321</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"a PyTorch scalar: "</span>, <span class="va">torch</span><span class="op">$</span><span class="fu">scalar_tensor</span><span class="op">(</span><span class="va">scalar</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; a PyTorch scalar: tensor(4.3210)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"\nResult"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Result</span>
<span class="op">(</span><span class="va">prod</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">mul</span><span class="op">(</span><span class="va">tensor</span>, <span class="va">torch</span><span class="op">$</span><span class="fu">scalar_tensor</span><span class="op">(</span><span class="va">scalar</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([4.3210, 4.3210, 4.3210, 4.3210], dtype=torch.float64)</span></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="co"># short version using generics</span>
<span class="op">(</span><span class="va">prod</span> <span class="op">=</span> <span class="va">tensor</span> <span class="op">*</span> <span class="va">scalar</span><span class="op">)</span>
<span class="co">#&gt; tensor([4.3210, 4.3210, 4.3210, 4.3210], dtype=torch.float64)</span></pre></div>
</div>
<div id="multiply-two-1d-tensors" class="section level3">
<h3 class="hasAnchor">
<a href="#multiply-two-1d-tensors" class="anchor"></a>Multiply two 1D tensors</h3>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="va">t1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">t2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="va">t1</span>
<span class="co">#&gt; tensor([1., 2.])</span>
<span class="va">t2</span>
<span class="co">#&gt; tensor([3., 2.])</span></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="va">t1</span> <span class="op">*</span> <span class="va">t2</span>
<span class="co">#&gt; tensor([3., 4.])</span></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="va">t1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>

<span class="va">t2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>

<span class="va">t1</span>
<span class="co">#&gt; tensor([[1., 2., 3.],</span>
<span class="co">#&gt;         [1., 2., 3.]])</span>
<span class="va">t2</span>
<span class="co">#&gt; tensor([[1., 2.],</span>
<span class="co">#&gt;         [1., 2.],</span>
<span class="co">#&gt;         [1., 2.]])</span></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="va">torch</span><span class="op">$</span><span class="fu">mm</span><span class="op">(</span><span class="va">t1</span>, <span class="va">t2</span><span class="op">)</span>
<span class="co">#&gt; tensor([[ 6., 12.],</span>
<span class="co">#&gt;         [ 6., 12.]])</span></pre></div>
</div>
<div id="dot-product-for-1d-tensors-vectors" class="section level3">
<h3 class="hasAnchor">
<a href="#dot-product-for-1d-tensors-vectors" class="anchor"></a>Dot product for 1D tensors (vectors)</h3>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="va">t1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">t2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="va">t1</span>
<span class="co">#&gt; tensor([1., 2.])</span>
<span class="va">t2</span>
<span class="co">#&gt; tensor([3., 2.])</span></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="co"># dot product of two vectors</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">dot</span><span class="op">(</span><span class="va">t1</span>, <span class="va">t2</span><span class="op">)</span>
<span class="co">#&gt; tensor(7.)</span></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="co"># Dot product of 1D tensors is a scalar</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">Tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span>
<span class="va">q</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">Tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">1L</span><span class="op">)</span><span class="op">)</span>                   

<span class="op">(</span><span class="va">r</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">dot</span><span class="op">(</span><span class="va">p</span>, <span class="va">q</span><span class="op">)</span><span class="op">)</span> <span class="co"># 14</span>
<span class="co">#&gt; tensor(14.)</span>
<span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">%.*%</span> <span class="va">q</span><span class="op">)</span>
<span class="co">#&gt; tensor(14.)</span></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="co"># torch$dot product will work for vectors not matrices</span>
<span class="va">t1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>

<span class="va">t2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>

<span class="va">t1</span><span class="op">$</span><span class="va">shape</span>
<span class="co">#&gt; torch.Size([2, 3])</span>
<span class="va">t2</span><span class="op">$</span><span class="va">shape</span>
<span class="co">#&gt; torch.Size([3, 2])</span></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit">
<span class="co"># RuntimeError: 1D tensors expected, got 2D, 2D tensors</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">dot</span><span class="op">(</span><span class="va">t1</span>, <span class="va">t2</span><span class="op">)</span></pre></div>
</div>
<div id="dot-product-for-2d-tensors-matrices" class="section level3">
<h3 class="hasAnchor">
<a href="#dot-product-for-2d-tensors-matrices" class="anchor"></a>Dot product for 2D tensors (matrices)</h3>
<p>The number of columns of the first matrix must be equal to the number of rows of the second matrix.</p>
<div class="sourceCode" id="cb27"><pre class="downlit">
<span class="co"># for the dot product of nD tensors we use torch$mm()</span>
<span class="va">t1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>

<span class="va">t2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>

<span class="va">torch</span><span class="op">$</span><span class="fu">mm</span><span class="op">(</span><span class="va">t1</span>, <span class="va">t2</span><span class="op">)</span>
<span class="co">#&gt; tensor([[ 6., 12.],</span>
<span class="co">#&gt;         [ 6., 12.]])</span></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit">
<span class="va">torch</span><span class="op">$</span><span class="fu">mm</span><span class="op">(</span><span class="va">t2</span>, <span class="va">t1</span><span class="op">)</span>
<span class="co">#&gt; tensor([[3., 6., 9.],</span>
<span class="co">#&gt;         [3., 6., 9.],</span>
<span class="co">#&gt;         [3., 6., 9.]])</span></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit">
<span class="co"># for the dot product of 2D tensors we use torch$mm()</span>
<span class="va">t1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">11</span><span class="op">)</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2L</span>,<span class="fl">5L</span><span class="op">)</span><span class="op">)</span>
<span class="va">t2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">11</span>, <span class="fl">21</span><span class="op">)</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5L</span>,<span class="fl">2L</span><span class="op">)</span><span class="op">)</span>

<span class="va">t1</span>
<span class="co">#&gt; tensor([[ 1.,  2.,  3.,  4.,  5.],</span>
<span class="co">#&gt;         [ 6.,  7.,  8.,  9., 10.]])</span>
<span class="va">t2</span>
<span class="co">#&gt; tensor([[11., 12.],</span>
<span class="co">#&gt;         [13., 14.],</span>
<span class="co">#&gt;         [15., 16.],</span>
<span class="co">#&gt;         [17., 18.],</span>
<span class="co">#&gt;         [19., 20.]])</span></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit">
<span class="co"># result</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">mm</span><span class="op">(</span><span class="va">t1</span>, <span class="va">t2</span><span class="op">)</span>
<span class="co">#&gt; tensor([[245., 260.],</span>
<span class="co">#&gt;         [620., 660.]])</span></pre></div>
</div>
<div id="multiplication-for-nd-tensors" class="section level3">
<h3 class="hasAnchor">
<a href="#multiplication-for-nd-tensors" class="anchor"></a>Multiplication for nD tensors</h3>
<div class="sourceCode" id="cb31"><pre class="downlit">
<span class="co"># 1D tensor</span>
<span class="va">t1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">t2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="va">torch</span><span class="op">$</span><span class="fu">matmul</span><span class="op">(</span><span class="va">t1</span>, <span class="va">t2</span><span class="op">)</span>
<span class="co">#&gt; tensor(7.)</span></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit">
<span class="co"># 2D tensor</span>
<span class="va">t1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>

<span class="va">t2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>

<span class="va">torch</span><span class="op">$</span><span class="fu">matmul</span><span class="op">(</span><span class="va">t1</span>, <span class="va">t2</span><span class="op">)</span>
<span class="co">#&gt; tensor([[ 6., 12.],</span>
<span class="co">#&gt;         [ 6., 12.]])</span></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit">
<span class="co"># for the dot product of 3D tensors we use torch$matmul()</span>
<span class="va">t1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">13</span><span class="op">)</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span>   <span class="co"># number of columns = 2</span>
<span class="va">t2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">18</span><span class="op">)</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span>   <span class="co"># number of rows = 2</span>

<span class="va">t1</span>
<span class="co">#&gt; tensor([[[ 1.,  2.,  3.],</span>
<span class="co">#&gt;          [ 4.,  5.,  6.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[ 7.,  8.,  9.],</span>
<span class="co">#&gt;          [10., 11., 12.]]])</span>
<span class="va">t2</span>
<span class="co">#&gt; tensor([[[ 0.,  1.,  2.],</span>
<span class="co">#&gt;          [ 3.,  4.,  5.],</span>
<span class="co">#&gt;          [ 6.,  7.,  8.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[ 9., 10., 11.],</span>
<span class="co">#&gt;          [12., 13., 14.],</span>
<span class="co">#&gt;          [15., 16., 17.]]])</span>

<span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"result"</span><span class="op">)</span>
<span class="co">#&gt; result</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">matmul</span><span class="op">(</span><span class="va">t1</span>, <span class="va">t2</span><span class="op">)</span>
<span class="co">#&gt; tensor([[[ 24.,  30.,  36.],</span>
<span class="co">#&gt;          [ 51.,  66.,  81.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[294., 318., 342.],</span>
<span class="co">#&gt;          [402., 435., 468.]]])</span></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit">
<span class="va">t1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">13</span><span class="op">)</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">2L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span>   <span class="co"># number of columns = 3</span>
<span class="va">t2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span><span class="op">)</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">2L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span>   <span class="co"># number of rows = 3</span>

<span class="va">t1</span>
<span class="co">#&gt; tensor([[[ 1.,  2.],</span>
<span class="co">#&gt;          [ 3.,  4.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[ 5.,  6.],</span>
<span class="co">#&gt;          [ 7.,  8.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[ 9., 10.],</span>
<span class="co">#&gt;          [11., 12.]]])</span>
<span class="va">t2</span>
<span class="co">#&gt; tensor([[[ 0.,  1.],</span>
<span class="co">#&gt;          [ 2.,  3.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[ 4.,  5.],</span>
<span class="co">#&gt;          [ 6.,  7.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[ 8.,  9.],</span>
<span class="co">#&gt;          [10., 11.]]])</span>

<span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"result"</span><span class="op">)</span>
<span class="co">#&gt; result</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">matmul</span><span class="op">(</span><span class="va">t1</span>, <span class="va">t2</span><span class="op">)</span>
<span class="co">#&gt; tensor([[[  4.,   7.],</span>
<span class="co">#&gt;          [  8.,  15.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[ 56.,  67.],</span>
<span class="co">#&gt;          [ 76.,  91.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[172., 191.],</span>
<span class="co">#&gt;          [208., 231.]]])</span></pre></div>
</div>
<div id="cross-product" class="section level3">
<h3 class="hasAnchor">
<a href="#cross-product" class="anchor"></a>cross product</h3>
<div class="sourceCode" id="cb35"><pre class="downlit">
<span class="va">m1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span>
<span class="va">m2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span>
<span class="va">v1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span><span class="op">)</span>
<span class="co"># Cross product</span>
<span class="co"># Size 3x5</span>
<span class="op">(</span><span class="va">r</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">cross</span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[0., 0., 0., 0., 0.],</span>
<span class="co">#&gt;         [0., 0., 0., 0., 0.],</span>
<span class="co">#&gt;         [0., 0., 0., 0., 0.]])</span></pre></div>
</div>
</div>
<div id="numpy-and-pytorch" class="section level2">
<h2 class="hasAnchor">
<a href="#numpy-and-pytorch" class="anchor"></a>NumPy and PyTorch</h2>
<p><code>numpy</code> has been made available as a module inside <code>rTorch</code>. We could call functions from <code>numpy</code> refrerring to it as <code>np$any_function</code>. Examples:</p>
<div class="sourceCode" id="cb36"><pre class="downlit">
<span class="co"># a 2D numpy array  </span>
<span class="va">syn0</span> <span class="op">&lt;-</span> <span class="va">np</span><span class="op">$</span><span class="va">random</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span>
<span class="va">syn0</span>
<span class="co">#&gt;           [,1]      [,2]      [,3]       [,4]       [,5]</span>
<span class="co">#&gt; [1,] 0.1524218 0.7769113 0.6153864 0.00220404 0.78412198</span>
<span class="co">#&gt; [2,] 0.4959399 0.7230621 0.9840282 0.64843544 0.06556167</span>
<span class="co">#&gt; [3,] 0.5931231 0.6513373 0.4399219 0.57722973 0.94843503</span></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit">
<span class="co"># numpy arrays of zeros</span>
<span class="va">syn1</span> <span class="op">&lt;-</span> <span class="va">np</span><span class="op">$</span><span class="fu">zeros</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">10L</span><span class="op">)</span><span class="op">)</span>
<span class="va">syn1</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span>
<span class="co">#&gt; [1,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt; [2,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt; [3,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt; [4,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt; [5,]    0    0    0    0    0    0    0    0    0     0</span></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit">
<span class="co"># add a scalar to a numpy array</span>
<span class="va">syn1</span> <span class="op">=</span> <span class="va">syn1</span> <span class="op">+</span> <span class="fl">0.1</span>
<span class="va">syn1</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span>
<span class="co">#&gt; [1,]  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1   0.1</span>
<span class="co">#&gt; [2,]  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1   0.1</span>
<span class="co">#&gt; [3,]  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1   0.1</span>
<span class="co">#&gt; [4,]  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1   0.1</span>
<span class="co">#&gt; [5,]  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1   0.1</span></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit">
<span class="co"># in numpy a multidimensional array needs to be defined with a tuple</span>
<span class="co"># From R we use a vector to refer to a tuple in Python</span>
<span class="va">l1</span> <span class="op">&lt;-</span> <span class="va">np</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">)</span>
<span class="va">l1</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span>
<span class="co">#&gt; [1,]    1    1    1    1    1</span>
<span class="co">#&gt; [2,]    1    1    1    1    1</span>
<span class="co">#&gt; [3,]    1    1    1    1    1</span>
<span class="co">#&gt; [4,]    1    1    1    1    1</span>
<span class="co">#&gt; [5,]    1    1    1    1    1</span></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit">
<span class="co"># vector-matrix multiplication</span>
<span class="va">np</span><span class="op">$</span><span class="fu">dot</span><span class="op">(</span><span class="va">syn0</span>, <span class="va">syn1</span><span class="op">)</span>
<span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]</span>
<span class="co">#&gt; [1,] 0.2331045 0.2331045 0.2331045 0.2331045 0.2331045 0.2331045 0.2331045</span>
<span class="co">#&gt; [2,] 0.2917027 0.2917027 0.2917027 0.2917027 0.2917027 0.2917027 0.2917027</span>
<span class="co">#&gt; [3,] 0.3210047 0.3210047 0.3210047 0.3210047 0.3210047 0.3210047 0.3210047</span>
<span class="co">#&gt;           [,8]      [,9]     [,10]</span>
<span class="co">#&gt; [1,] 0.2331045 0.2331045 0.2331045</span>
<span class="co">#&gt; [2,] 0.2917027 0.2917027 0.2917027</span>
<span class="co">#&gt; [3,] 0.3210047 0.3210047 0.3210047</span></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit">
<span class="co"># build a numpy array from three R vectors</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="va">np</span><span class="op">$</span><span class="fu">array</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">X</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]    1    2    3</span>
<span class="co">#&gt; [2,]    4    5    6</span>
<span class="co">#&gt; [3,]    7    8    9</span></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit">
<span class="co"># transpose the array</span>
<span class="va">np</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]    1    4    7</span>
<span class="co">#&gt; [2,]    2    5    8</span>
<span class="co">#&gt; [3,]    3    6    9</span></pre></div>
<div id="copying-a-numpy-object" class="section level3">
<h3 class="hasAnchor">
<a href="#copying-a-numpy-object" class="anchor"></a>Copying a numpy object</h3>
<p>With newer PyTorch versions we should work with NumPy array copies There have been minor changes in the latest versions of PyTorch that prevents a direct use of a NumPy array. You will get this warning:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>sys<span class="op">:</span><span class="dv">1</span><span class="op">:</span><span class="st"> </span>UserWarning<span class="op">:</span><span class="st"> </span>The given NumPy array is not writeable, and PyTorch does </span>
<span id="cb43-2"><a href="#cb43-2"></a>not support non<span class="op">-</span>writeable tensors. This means you can write to the underlying</span>
<span id="cb43-3"><a href="#cb43-3"></a>(supposedly non<span class="op">-</span>writeable) NumPy array using the tensor. You may want to copy </span>
<span id="cb43-4"><a href="#cb43-4"></a>the array to protect its data or make it writeable before converting it to a </span>
<span id="cb43-5"><a href="#cb43-5"></a>tensor. This type of warning will be suppressed <span class="cf">for</span> the rest of this program.</span></code></pre></div>
<p>For instance, this code will produce the warning:</p>
<div class="sourceCode" id="cb44"><pre class="downlit">
<span class="co"># as_tensor. Modifying tensor modifies numpy object as well</span>
<span class="va">a</span> <span class="op">=</span> <span class="va">np</span><span class="op">$</span><span class="fu">array</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">t</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">as_tensor</span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>

<span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fl">1</span>,  <span class="fl">2</span>,  <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">t</span><span class="op">[</span><span class="fl">1L</span><span class="op">]</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></pre></div>
<p>while this other one -with some extra code- will not:</p>
<div class="sourceCode" id="cb45"><pre class="downlit">
<span class="va">a</span> <span class="op">=</span> <span class="va">np</span><span class="op">$</span><span class="fu">array</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">a_copy</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/r-py-conversion.html">r_to_py</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="op">)</span>             <span class="co"># we make a copy of the numpy array first</span>

<span class="va">t</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">as_tensor</span><span class="op">(</span><span class="va">a_copy</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>
<span class="co">#&gt; tensor([1., 2., 3.], dtype=torch.float64)</span>

<span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fl">1</span>,  <span class="fl">2</span>,  <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([1., 2., 3.])</span>
<span class="va">t</span><span class="op">[</span><span class="fl">1L</span><span class="op">]</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; tensor(-1., dtype=torch.float64)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="co">#&gt; [1] 1 2 3</span></pre></div>
</div>
<div id="function-make_copy" class="section level3">
<h3 class="hasAnchor">
<a href="#function-make_copy" class="anchor"></a>Function <code>make_copy()</code>
</h3>
<p>To make easier to copy an object in <code>rTorch</code> we implemented the function <code>make_copy</code>, which makes a safe copy regardless if it is a torch, numpy or an R type object.</p>
<div class="sourceCode" id="cb46"><pre class="downlit">
<span class="va">a</span> <span class="op">=</span> <span class="va">np</span><span class="op">$</span><span class="fu">array</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>

<span class="va">a_copy</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/make_copy.html">make_copy</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">as_tensor</span><span class="op">(</span><span class="va">a_copy</span><span class="op">)</span>
<span class="va">t</span>
<span class="co">#&gt; tensor([1., 2., 3., 4., 5.], dtype=torch.float64)</span></pre></div>
</div>
<div id="convert-a-numpy-array-to-a-tensor" class="section level3">
<h3 class="hasAnchor">
<a href="#convert-a-numpy-array-to-a-tensor" class="anchor"></a>Convert a numpy array to a tensor</h3>
<div class="sourceCode" id="cb47"><pre class="downlit">
<span class="co"># convert a numpy array to a tensor</span>
<span class="va">np_a</span> <span class="op">=</span> <span class="va">np</span><span class="op">$</span><span class="fu">array</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">t_a</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">from_numpy</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/r-py-conversion.html">r_to_py</a></span><span class="op">(</span><span class="va">np_a</span><span class="op">)</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">t_a</span><span class="op">)</span>
<span class="co">#&gt; tensor([3., 4., 3., 6.], dtype=torch.float64)</span></pre></div>
</div>
</div>
<div id="creating-tensors" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-tensors" class="anchor"></a>Creating tensors</h2>
<div id="random-tensor" class="section level3">
<h3 class="hasAnchor">
<a href="#random-tensor" class="anchor"></a>Random tensor</h3>
<div class="sourceCode" id="cb48"><pre class="downlit">
<span class="co"># a random 1D tensor</span>
<span class="va">np_arr</span> <span class="op">&lt;-</span> <span class="va">np</span><span class="op">$</span><span class="va">random</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">5L</span><span class="op">)</span>
<span class="va">ft1</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/r-py-conversion.html">r_to_py</a></span><span class="op">(</span><span class="va">np_arr</span><span class="op">)</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>    <span class="co"># make a copy of numpy array</span>
<span class="va">ft1</span>
<span class="co">#&gt; tensor([0.9408, 0.8752, 0.5924, 0.7329, 0.6719])</span></pre></div>
<div class="sourceCode" id="cb49"><pre class="downlit">
<span class="co"># tensor as a float of 64-bits</span>
<span class="va">np_copy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/r-py-conversion.html">r_to_py</a></span><span class="op">(</span><span class="va">np</span><span class="op">$</span><span class="va">random</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">5L</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="op">)</span>       <span class="co"># make a copy of numpy array</span>
<span class="va">ft2</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">as_tensor</span><span class="op">(</span><span class="va">np_copy</span>, dtype<span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="va">float64</span><span class="op">)</span>
<span class="va">ft2</span>
<span class="co">#&gt; tensor([0.0462, 0.5851, 0.4886, 0.0725, 0.8959], dtype=torch.float64)</span></pre></div>
<p>This is a very common operation in machine learning:</p>
<div class="sourceCode" id="cb50"><pre class="downlit">
<span class="co"># convert tensor to a numpy array</span>
<span class="va">a</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">4L</span><span class="op">)</span>
<span class="va">b</span> <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span>
<span class="co">#&gt;           [,1]      [,2]         [,3]      [,4]</span>
<span class="co">#&gt; [1,] 0.8167720 0.8075168 0.2668687105 0.7421414</span>
<span class="co">#&gt; [2,] 0.6829966 0.5185235 0.0005332828 0.9414444</span>
<span class="co">#&gt; [3,] 0.2030416 0.7496545 0.0358363986 0.3475423</span>
<span class="co">#&gt; [4,] 0.7263991 0.6163300 0.2169904113 0.9363614</span>
<span class="co">#&gt; [5,] 0.4336911 0.5996053 0.2127178907 0.8461853</span></pre></div>
</div>
<div id="change-the-type-of-a-tensor" class="section level3">
<h3 class="hasAnchor">
<a href="#change-the-type-of-a-tensor" class="anchor"></a>Change the type of a tensor</h3>
<div class="sourceCode" id="cb51"><pre class="downlit">
<span class="co"># convert tensor to float 16-bits</span>
<span class="va">ft2_dbl</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">as_tensor</span><span class="op">(</span><span class="va">ft2</span>, dtype <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="va">float16</span><span class="op">)</span>
<span class="va">ft2_dbl</span>
<span class="co">#&gt; tensor([0.0462, 0.5850, 0.4885, 0.0724, 0.8960], dtype=torch.float16)</span></pre></div>
</div>
<div id="create-an-uninitialized-tensor" class="section level3">
<h3 class="hasAnchor">
<a href="#create-an-uninitialized-tensor" class="anchor"></a>Create an uninitialized tensor</h3>
<p>Create a tensor of size (5 x 7) with uninitialized memory:</p>
<div class="sourceCode" id="cb52"><pre class="downlit">
<span class="va">a</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">7L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="co">#&gt; tensor([[1.4013e-45, 1.4013e-45, 1.4013e-45, 1.4013e-45, 1.4013e-45, 1.4013e-45,</span>
<span class="co">#&gt;          1.4013e-45],</span>
<span class="co">#&gt;         [1.4013e-45, 1.4013e-45, 1.4013e-45, 1.4013e-45, 1.4013e-45, 1.4013e-45,</span>
<span class="co">#&gt;          1.4013e-45],</span>
<span class="co">#&gt;         [1.4013e-45, 1.4013e-45, 1.4013e-45, 1.4013e-45, 1.4013e-45, 1.4013e-45,</span>
<span class="co">#&gt;          1.4013e-45],</span>
<span class="co">#&gt;         [1.4013e-45, 1.4013e-45, 1.4013e-45, 1.4013e-45, 1.4013e-45, 1.4013e-45,</span>
<span class="co">#&gt;          1.4013e-45],</span>
<span class="co">#&gt;         [1.4013e-45, 1.4013e-45, 0.0000e+00, 1.4013e-45, 1.4013e-45, 1.4013e-45,</span>
<span class="co">#&gt;          1.4013e-45]])</span></pre></div>
</div>
<div id="create-a-tensor-and-then-change-its-shape" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-tensor-and-then-change-its-shape" class="anchor"></a>Create a tensor and then change its shape</h3>
<div class="sourceCode" id="cb53"><pre class="downlit">
<span class="co"># using arange to create tensor. starts from 0</span>
<span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">9L</span><span class="op">)</span>
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">v</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[0, 1, 2],</span>
<span class="co">#&gt;         [3, 4, 5],</span>
<span class="co">#&gt;         [6, 7, 8]])</span></pre></div>
</div>
</div>
<div id="distributions" class="section level2">
<h2 class="hasAnchor">
<a href="#distributions" class="anchor"></a>Distributions</h2>
<p>Initialize a tensor randomized with a normal distribution with mean=0, var=1:</p>
<div class="sourceCode" id="cb54"><pre class="downlit">
<span class="va">a</span>  <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">randn</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">7L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="co">#&gt; tensor([[-0.9889,  0.6058,  0.5492, -0.0291,  1.3752, -0.2528, -1.8089],</span>
<span class="co">#&gt;         [ 0.6621, -0.4370,  1.5590,  0.8149,  0.4004, -0.5299,  0.9275],</span>
<span class="co">#&gt;         [ 0.0880,  0.5931,  0.2601,  1.6336,  1.0154,  1.2189, -1.6278],</span>
<span class="co">#&gt;         [ 1.2171,  0.1377, -0.2377,  0.0792, -0.2885,  0.6316,  1.7481],</span>
<span class="co">#&gt;         [-0.7538,  0.6162,  1.3023, -1.5574,  0.1196, -1.1652,  1.5082]])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([5, 7])</span></pre></div>
<div id="uniform-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#uniform-matrix" class="anchor"></a>Uniform matrix</h3>
<div class="sourceCode" id="cb55"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/f0nzie/rTorch">rTorch</a></span><span class="op">)</span>

<span class="co"># 3x5 matrix uniformly distributed between 0 and 1</span>
<span class="va">mat0</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">$</span><span class="fu">uniform_</span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">1L</span><span class="op">)</span>

<span class="co"># fill a 3x5 matrix with 0.1</span>
<span class="va">mat1</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">$</span><span class="fu">uniform_</span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>

<span class="co"># a vector with all ones</span>
<span class="va">mat2</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">5L</span><span class="op">)</span><span class="op">$</span><span class="fu">uniform_</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>

<span class="va">mat0</span>
<span class="co">#&gt; tensor([[0.9587, 0.3368, 0.3534, 0.0709, 0.6827],</span>
<span class="co">#&gt;         [0.5521, 0.6874, 0.6756, 0.3705, 0.9120],</span>
<span class="co">#&gt;         [0.4415, 0.9895, 0.4699, 0.5890, 0.0901]])</span>
<span class="va">mat1</span>
<span class="co">#&gt; tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1000],</span>
<span class="co">#&gt;         [0.1000, 0.1000, 0.1000, 0.1000, 0.1000],</span>
<span class="co">#&gt;         [0.1000, 0.1000, 0.1000, 0.1000, 0.1000]])</span></pre></div>
</div>
<div id="binomial-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#binomial-distribution" class="anchor"></a>Binomial distribution</h3>
<div class="sourceCode" id="cb56"><pre class="downlit">
<span class="va">Binomial</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="va">distributions</span><span class="op">$</span><span class="va">binomial</span><span class="op">$</span><span class="va">Binomial</span>

<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">Binomial</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0</span> , <span class="fl">.2</span>, <span class="fl">.8</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">(</span><span class="va">x</span> <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([  0.,  29.,  80., 100.])</span></pre></div>
<div class="sourceCode" id="cb57"><pre class="downlit">
<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">Binomial</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">5.</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">10.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, 
             <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">(</span><span class="va">x</span> <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[0., 4.],</span>
<span class="co">#&gt;         [2., 8.]])</span></pre></div>
</div>
<div id="exponential-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#exponential-distribution" class="anchor"></a>Exponential distribution</h3>
<div class="sourceCode" id="cb58"><pre class="downlit">
<span class="va">Exponential</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="va">distributions</span><span class="op">$</span><span class="va">exponential</span><span class="op">$</span><span class="va">Exponential</span>

<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">Exponential</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span><span class="op">)</span>  <span class="co"># Exponential distributed with rate=1</span>
<span class="co">#&gt; tensor([0.4214])</span></pre></div>
</div>
<div id="weibull-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#weibull-distribution" class="anchor"></a>Weibull distribution</h3>
<div class="sourceCode" id="cb59"><pre class="downlit">
<span class="va">Weibull</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="va">distributions</span><span class="op">$</span><span class="va">weibull</span><span class="op">$</span><span class="va">Weibull</span>

<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">Weibull</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span><span class="op">)</span>, <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span><span class="op">)</span>  <span class="co"># sample from a Weibull distribution with scale=1, concentration=1</span>
<span class="co">#&gt; tensor([0.0745])</span></pre></div>
</div>
</div>
<div id="tensor-default-data-types" class="section level2">
<h2 class="hasAnchor">
<a href="#tensor-default-data-types" class="anchor"></a>Tensor default data types</h2>
<p>Only floating-point types are supported as the default type.</p>
<div id="float32" class="section level3">
<h3 class="hasAnchor">
<a href="#float32" class="anchor"></a>float32</h3>
<div class="sourceCode" id="cb60"><pre class="downlit">
<span class="co"># Default data type</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">dtype</span>  <span class="co"># default for floating point is torch.float32</span>
<span class="co">#&gt; torch.float32</span></pre></div>
</div>
<div id="float64" class="section level3">
<h3 class="hasAnchor">
<a href="#float64" class="anchor"></a>float64</h3>
<div class="sourceCode" id="cb61"><pre class="downlit">
<span class="co"># change default data type to float64</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">set_default_dtype</span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="va">float64</span><span class="op">)</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">dtype</span>         <span class="co"># a new floating point tensor</span>
<span class="co">#&gt; torch.float64</span></pre></div>
</div>
<div id="double" class="section level3">
<h3 class="hasAnchor">
<a href="#double" class="anchor"></a>double</h3>
<div class="sourceCode" id="cb62"><pre class="downlit">
<span class="va">torch</span><span class="op">$</span><span class="fu">set_default_dtype</span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="va">double</span><span class="op">)</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">dtype</span>
<span class="co">#&gt; torch.float64</span></pre></div>
</div>
</div>
<div id="tensor-resizing" class="section level2">
<h2 class="hasAnchor">
<a href="#tensor-resizing" class="anchor"></a>Tensor resizing</h2>
<div id="using-view" class="section level3">
<h3 class="hasAnchor">
<a href="#using-view" class="anchor"></a>Using <em>view</em>
</h3>
<div class="sourceCode" id="cb63"><pre class="downlit">
<span class="va">x</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">randn</span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span>            <span class="co"># Size 2x3</span>
<span class="va">y</span> <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fl">6L</span><span class="op">)</span>                    <span class="co"># Resize x to size 6</span>
<span class="va">z</span> <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="op">-</span><span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span>                <span class="co"># Size 3x2</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; tensor([ 0.8073, -0.7656,  1.0641,  0.3801,  0.5983,  0.7950])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>
<span class="co">#&gt; tensor([[ 0.8073, -0.7656],</span>
<span class="co">#&gt;         [ 1.0641,  0.3801],</span>
<span class="co">#&gt;         [ 0.5983,  0.7950]])</span></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit">
<span class="co"># 0 1 2</span>
<span class="co"># 3 4 5</span>
<span class="co"># 6 7 8</span>
<span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">9L</span><span class="op">)</span>
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">v</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[0, 1, 2],</span>
<span class="co">#&gt;         [3, 4, 5],</span>
<span class="co">#&gt;         [6, 7, 8]])</span></pre></div>
</div>
<div id="concatenating-tensors" class="section level3">
<h3 class="hasAnchor">
<a href="#concatenating-tensors" class="anchor"></a>Concatenating tensors</h3>
<div class="sourceCode" id="cb65"><pre class="downlit">
<span class="co"># concatenate tensors</span>
<span class="va">x</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">randn</span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; tensor([[-0.6563,  1.5943, -0.0617],</span>
<span class="co">#&gt;         [ 0.5502,  1.6150, -2.0000]])</span>

<span class="co"># concatenate tensors by dim=0"</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">cat</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span><span class="op">)</span>, <span class="fl">0L</span><span class="op">)</span>
<span class="co">#&gt; tensor([[-0.6563,  1.5943, -0.0617],</span>
<span class="co">#&gt;         [ 0.5502,  1.6150, -2.0000],</span>
<span class="co">#&gt;         [-0.6563,  1.5943, -0.0617],</span>
<span class="co">#&gt;         [ 0.5502,  1.6150, -2.0000],</span>
<span class="co">#&gt;         [-0.6563,  1.5943, -0.0617],</span>
<span class="co">#&gt;         [ 0.5502,  1.6150, -2.0000]])</span>

<span class="co"># concatenate tensors by dim=1</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">cat</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span><span class="op">)</span>, <span class="fl">1L</span><span class="op">)</span>
<span class="co">#&gt; tensor([[-0.6563,  1.5943, -0.0617, -0.6563,  1.5943, -0.0617, -0.6563,  1.5943,</span>
<span class="co">#&gt;          -0.0617],</span>
<span class="co">#&gt;         [ 0.5502,  1.6150, -2.0000,  0.5502,  1.6150, -2.0000,  0.5502,  1.6150,</span>
<span class="co">#&gt;          -2.0000]])</span></pre></div>
</div>
<div id="reshape-tensors" class="section level3">
<h3 class="hasAnchor">
<a href="#reshape-tensors" class="anchor"></a>Reshape tensors</h3>
<div class="sourceCode" id="cb66"><pre class="downlit">
<span class="co"># ----- Reshape tensors -----</span>
<span class="va">img</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([3, 28, 28])</span>

<span class="va">img_chunks</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">chunk</span><span class="op">(</span><span class="va">img</span>, chunks <span class="op">=</span> <span class="fl">3L</span>, dim <span class="op">=</span> <span class="fl">0L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">img_chunks</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 3</span>

<span class="co"># 1st chunk member</span>
<span class="va">img_chunk_1</span> <span class="op">&lt;-</span> <span class="va">img_chunks</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_chunk_1</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([1, 28, 28])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_chunk_1</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(784.)</span>

<span class="co"># 2nd chunk member</span>
<span class="va">img_chunk_1</span> <span class="op">&lt;-</span> <span class="va">img_chunks</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_chunk_1</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([1, 28, 28])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_chunk_1</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(784.)</span>


<span class="co"># index_select. get layer 1</span>
<span class="va">indices</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0L</span><span class="op">)</span><span class="op">)</span>
<span class="va">img2</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">index_select</span><span class="op">(</span><span class="va">img</span>, dim <span class="op">=</span> <span class="fl">0L</span>, index <span class="op">=</span> <span class="va">indices</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img2</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([1, 28, 28])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img2</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(784.)</span>

<span class="co"># index_select. get layer 2</span>
<span class="va">indices</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1L</span><span class="op">)</span><span class="op">)</span>
<span class="va">img2</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">index_select</span><span class="op">(</span><span class="va">img</span>, dim <span class="op">=</span> <span class="fl">0L</span>, index <span class="op">=</span> <span class="va">indices</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img2</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([1, 28, 28])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img2</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(784.)</span>

<span class="co"># index_select. get layer 3</span>
<span class="va">indices</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span><span class="op">)</span>
<span class="va">img2</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">index_select</span><span class="op">(</span><span class="va">img</span>, dim <span class="op">=</span> <span class="fl">0L</span>, index <span class="op">=</span> <span class="va">indices</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img2</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([1, 28, 28])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img2</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(784.)</span></pre></div>
</div>
</div>
<div id="special-tensors" class="section level2">
<h2 class="hasAnchor">
<a href="#special-tensors" class="anchor"></a>Special tensors</h2>
<div id="identity-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#identity-matrix" class="anchor"></a>Identity matrix</h3>
<div class="sourceCode" id="cb67"><pre class="downlit">
<span class="co"># identity matrix</span>
<span class="va">eye</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">eye</span><span class="op">(</span><span class="fl">3L</span><span class="op">)</span>              <span class="co"># Create an identity 3x3 tensor</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">eye</span><span class="op">)</span>
<span class="co">#&gt; tensor([[1., 0., 0.],</span>
<span class="co">#&gt;         [0., 1., 0.],</span>
<span class="co">#&gt;         [0., 0., 1.]])</span></pre></div>
</div>
<div id="ones" class="section level3">
<h3 class="hasAnchor">
<a href="#ones" class="anchor"></a>Ones</h3>
<div class="sourceCode" id="cb68"><pre class="downlit">
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">10L</span><span class="op">)</span><span class="op">)</span>              <span class="co"># A tensor of size 10 containing all ones</span>
<span class="co">#&gt; tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1.])</span>
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">1L</span><span class="op">)</span><span class="op">)</span>      <span class="co"># Size 2x1x2x1</span>
<span class="co">#&gt; tensor([[[[1.],</span>
<span class="co">#&gt;           [1.]]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[[1.],</span>
<span class="co">#&gt;           [1.]]]])</span></pre></div>
</div>
<div id="eye" class="section level3">
<h3 class="hasAnchor">
<a href="#eye" class="anchor"></a>Eye</h3>
<div class="sourceCode" id="cb69"><pre class="downlit">
<span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones_like</span><span class="op">(</span><span class="va">eye</span><span class="op">)</span>     <span class="co"># A tensor with same shape as eye. Fill it with 1.</span>
<span class="va">v</span>
<span class="co">#&gt; tensor([[1., 1., 1.],</span>
<span class="co">#&gt;         [1., 1., 1.],</span>
<span class="co">#&gt;         [1., 1., 1.]])</span></pre></div>
</div>
<div id="zeros" class="section level3">
<h3 class="hasAnchor">
<a href="#zeros" class="anchor"></a>Zeros</h3>
<div class="sourceCode" id="cb70"><pre class="downlit">
<span class="op">(</span><span class="va">z</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">zeros</span><span class="op">(</span><span class="fl">10L</span><span class="op">)</span><span class="op">)</span>             <span class="co"># A tensor of size 10 containing all zeros</span>
<span class="co">#&gt; tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])</span></pre></div>
</div>
</div>
<div id="tensor-fill" class="section level2">
<h2 class="hasAnchor">
<a href="#tensor-fill" class="anchor"></a>Tensor fill</h2>
<div id="fill-with-a-unique-value" class="section level3">
<h3 class="hasAnchor">
<a href="#fill-with-a-unique-value" class="anchor"></a>Fill with a unique value</h3>
<div class="sourceCode" id="cb71"><pre class="downlit">
<span class="co"># a tensor filled with ones</span>
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[1., 1., 1.],</span>
<span class="co">#&gt;         [1., 1., 1.],</span>
<span class="co">#&gt;         [1., 1., 1.]])</span></pre></div>
</div>
<div id="change-the-tensor-values-by-rows" class="section level3">
<h3 class="hasAnchor">
<a href="#change-the-tensor-values-by-rows" class="anchor"></a>Change the tensor values by rows</h3>
<div class="sourceCode" id="cb72"><pre class="downlit">
<span class="co"># change two rows in the tensor</span>
<span class="co"># we are using 1-based index</span>
<span class="va">v</span><span class="op">[</span><span class="fl">2L</span>, <span class="op">]</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span>         <span class="co"># fill row 1 with 2s</span>
<span class="co">#&gt; tensor([2., 2., 2.])</span>
<span class="va">v</span><span class="op">[</span><span class="fl">3L</span>, <span class="op">]</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="fl">3L</span><span class="op">)</span>         <span class="co"># fill row 2 with 3s</span>
<span class="co">#&gt; tensor([3., 3., 3.])</span></pre></div>
<div class="sourceCode" id="cb73"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span>
<span class="co">#&gt; tensor([[1., 1., 1.],</span>
<span class="co">#&gt;         [2., 2., 2.],</span>
<span class="co">#&gt;         [3., 3., 3.]])</span></pre></div>
</div>
<div id="fill-a-tensor-with-a-set-increment" class="section level3">
<h3 class="hasAnchor">
<a href="#fill-a-tensor-with-a-set-increment" class="anchor"></a>Fill a tensor with a set increment</h3>
<div class="sourceCode" id="cb74"><pre class="downlit">
<span class="co"># Initialize Tensor with a range of values</span>
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">10L</span><span class="op">)</span><span class="op">)</span>             <span class="co"># similar to range(5) but creating a Tensor</span>
<span class="co">#&gt; tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit">
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">10L</span>, step <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Size 5. Similar to range(0, 5, 1)</span>
<span class="co">#&gt; tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span></pre></div>
</div>
<div id="with-decimal-increments" class="section level3">
<h3 class="hasAnchor">
<a href="#with-decimal-increments" class="anchor"></a>With decimal increments</h3>
<div class="sourceCode" id="cb76"><pre class="downlit">
<span class="va">u</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, step <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">u</span>
<span class="co">#&gt; tensor([0.0000, 0.5000, 1.0000, 1.5000, 2.0000, 2.5000, 3.0000, 3.5000, 4.0000,</span>
<span class="co">#&gt;         4.5000, 5.0000, 5.5000, 6.0000, 6.5000, 7.0000, 7.5000, 8.0000, 8.5000,</span>
<span class="co">#&gt;         9.0000, 9.5000])</span></pre></div>
</div>
<div id="including-the-ending-value" class="section level3">
<h3 class="hasAnchor">
<a href="#including-the-ending-value" class="anchor"></a>Including the ending value</h3>
<div class="sourceCode" id="cb77"><pre class="downlit">
<span class="co"># range of values with increments including the end value</span>
<span class="va">start</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">end</span>   <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">step</span>  <span class="op">&lt;-</span> <span class="fl">0.25</span>

<span class="va">w</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="va">start</span>, <span class="va">end</span><span class="op">+</span><span class="va">step</span>, <span class="va">step</span><span class="op">)</span>
<span class="va">w</span>
<span class="co">#&gt; tensor([ 0.0000,  0.2500,  0.5000,  0.7500,  1.0000,  1.2500,  1.5000,  1.7500,</span>
<span class="co">#&gt;          2.0000,  2.2500,  2.5000,  2.7500,  3.0000,  3.2500,  3.5000,  3.7500,</span>
<span class="co">#&gt;          4.0000,  4.2500,  4.5000,  4.7500,  5.0000,  5.2500,  5.5000,  5.7500,</span>
<span class="co">#&gt;          6.0000,  6.2500,  6.5000,  6.7500,  7.0000,  7.2500,  7.5000,  7.7500,</span>
<span class="co">#&gt;          8.0000,  8.2500,  8.5000,  8.7500,  9.0000,  9.2500,  9.5000,  9.7500,</span>
<span class="co">#&gt;         10.0000])</span></pre></div>
</div>
<div id="initialize-a-linear-or-log-scale-tensor" class="section level3">
<h3 class="hasAnchor">
<a href="#initialize-a-linear-or-log-scale-tensor" class="anchor"></a>Initialize a linear or log scale Tensor</h3>
<div class="sourceCode" id="cb78"><pre class="downlit">
<span class="co"># Initialize a linear or log scale Tensor</span>

<span class="co"># Create a Tensor with 10 linear points for (1, 10) inclusively</span>
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">linspace</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">10L</span>, steps <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt; tensor([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10.])</span>

<span class="co"># Size 5: 1.0e-10 1.0e-05 1.0e+00, 1.0e+05, 1.0e+10</span>
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">logspace</span><span class="op">(</span>start<span class="op">=</span><span class="op">-</span><span class="fl">10L</span>, end <span class="op">=</span> <span class="fl">10L</span>, steps <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt; tensor([1.0000e-10, 1.0000e-05, 1.0000e+00, 1.0000e+05, 1.0000e+10])</span></pre></div>
</div>
<div id="in-place--not-in-place" class="section level3">
<h3 class="hasAnchor">
<a href="#in-place--not-in-place" class="anchor"></a>In-place / Not-in-place</h3>
<div class="sourceCode" id="cb79"><pre class="downlit">
<span class="va">a</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">4L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "torch.Tensor"          "torch._C._TensorBase"  "python.builtin.object"</span></pre></div>
<div class="sourceCode" id="cb80"><pre class="downlit">
<span class="co"># converting the tensor to a numpy array, R automatically converts it</span>
<span class="va">b</span> <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "matrix"</span></pre></div>
<div class="sourceCode" id="cb81"><pre class="downlit">
<span class="va">a</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="fl">3.5</span><span class="op">)</span>
<span class="co">#&gt; tensor([[3.5000, 3.5000, 3.5000, 3.5000],</span>
<span class="co">#&gt;         [3.5000, 3.5000, 3.5000, 3.5000],</span>
<span class="co">#&gt;         [3.5000, 3.5000, 3.5000, 3.5000],</span>
<span class="co">#&gt;         [3.5000, 3.5000, 3.5000, 3.5000],</span>
<span class="co">#&gt;         [3.5000, 3.5000, 3.5000, 3.5000]])</span>
<span class="co"># a has now been filled with the value 3.5</span>

<span class="co"># add a scalar to a tensor. </span>
<span class="co"># notice that was auto-converted from an array to a tensor</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="fl">4.0</span><span class="op">)</span>

<span class="co"># a is still filled with 3.5</span>
<span class="co"># new tensor b is returned with values 3.5 + 4.0 = 7.5</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="co">#&gt; tensor([[3.5000, 3.5000, 3.5000, 3.5000],</span>
<span class="co">#&gt;         [3.5000, 3.5000, 3.5000, 3.5000],</span>
<span class="co">#&gt;         [3.5000, 3.5000, 3.5000, 3.5000],</span>
<span class="co">#&gt;         [3.5000, 3.5000, 3.5000, 3.5000],</span>
<span class="co">#&gt;         [3.5000, 3.5000, 3.5000, 3.5000]])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span>
<span class="co">#&gt; tensor([[7.5000, 7.5000, 7.5000, 7.5000],</span>
<span class="co">#&gt;         [7.5000, 7.5000, 7.5000, 7.5000],</span>
<span class="co">#&gt;         [7.5000, 7.5000, 7.5000, 7.5000],</span>
<span class="co">#&gt;         [7.5000, 7.5000, 7.5000, 7.5000],</span>
<span class="co">#&gt;         [7.5000, 7.5000, 7.5000, 7.5000]])</span></pre></div>
</div>
<div id="tensor-element-assigment-not-implemented-yet" class="section level3">
<h3 class="hasAnchor">
<a href="#tensor-element-assigment-not-implemented-yet" class="anchor"></a>Tensor element assigment not implemented yet</h3>
<div class="sourceCode" id="cb82"><pre class="downlit">
<span class="co"># this will throw an error because we don't still have a function for assignment</span>
<span class="va">a</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">7.7</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="co"># Error in a[1, 1] &lt;- 7.7 : object of type 'environment' is not subsettable</span></pre></div>
<div class="sourceCode" id="cb83"><pre class="downlit">
<span class="co"># This would be the right wayy to assign a value to a tensor element</span>
<span class="va">a</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="fl">7.7</span><span class="op">)</span>
<span class="co">#&gt; tensor(7.7000)</span></pre></div>
<div class="sourceCode" id="cb84"><pre class="downlit">
<span class="co"># we can see that the first element has been changed</span>
<span class="va">a</span>
<span class="co">#&gt; tensor([[7.7000, 3.5000, 3.5000, 3.5000],</span>
<span class="co">#&gt;         [3.5000, 3.5000, 3.5000, 3.5000],</span>
<span class="co">#&gt;         [3.5000, 3.5000, 3.5000, 3.5000],</span>
<span class="co">#&gt;         [3.5000, 3.5000, 3.5000, 3.5000],</span>
<span class="co">#&gt;         [3.5000, 3.5000, 3.5000, 3.5000]])</span></pre></div>
<blockquote>
<p>Some operations like<code>narrow</code> do not have in-place versions, and hence, <code>.narrow_</code> does not exist. Similarly, some operations like <code>fill_</code> do not have an out-of-place version, so <code>.fill</code> does not exist.</p>
</blockquote>
<div class="sourceCode" id="cb85"><pre class="downlit">
<span class="co"># a[[0L, 3L]]</span>
<span class="va">a</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">]</span>
<span class="co">#&gt; tensor(3.5000)</span></pre></div>
</div>
</div>
<div id="access-to-tensor-elements" class="section level2">
<h2 class="hasAnchor">
<a href="#access-to-tensor-elements" class="anchor"></a>Access to tensor elements</h2>
<div id="change-a-tensor-element-given-its-index" class="section level3">
<h3 class="hasAnchor">
<a href="#change-a-tensor-element-given-its-index" class="anchor"></a>Change a tensor element given its index</h3>
<div class="sourceCode" id="cb86"><pre class="downlit">
<span class="co"># replace an element at position 0, 0</span>
<span class="op">(</span><span class="va">new_tensor</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">Tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[1., 2.],</span>
<span class="co">#&gt;         [3., 4.]])</span></pre></div>
<div class="sourceCode" id="cb87"><pre class="downlit">
<span class="co"># first row, firt column</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">new_tensor</span><span class="op">[</span><span class="fl">1L</span>, <span class="fl">1L</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; tensor(1.)</span></pre></div>
<div class="sourceCode" id="cb88"><pre class="downlit">
<span class="co"># change row 1, col 1 with value of 5</span>
<span class="va">new_tensor</span><span class="op">[</span><span class="fl">1L</span>, <span class="fl">1L</span><span class="op">]</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; tensor(5.)</span></pre></div>
<div class="sourceCode" id="cb89"><pre class="downlit">
<span class="co"># which is the same as doing this</span>
<span class="va">new_tensor</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; tensor(5.)</span></pre></div>
<blockquote>
<p>Notice that the element was changed in-place because of <code>fill_</code>.</p>
</blockquote>
</div>
<div id="in-r-the-index-is-1-based" class="section level3">
<h3 class="hasAnchor">
<a href="#in-r-the-index-is-1-based" class="anchor"></a>In R the index is 1-based</h3>
<div class="sourceCode" id="cb90"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">new_tensor</span><span class="op">)</span>   <span class="co"># tensor([[ 5.,  2.],[ 3.,  4.]])</span>
<span class="co">#&gt; tensor([[5., 2.],</span>
<span class="co">#&gt;         [3., 4.]])</span></pre></div>
<div class="sourceCode" id="cb91"><pre class="downlit">
<span class="co"># access an element at position (1, 0), 0-based index</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">new_tensor</span><span class="op">[</span><span class="fl">2L</span>, <span class="fl">1L</span><span class="op">]</span><span class="op">)</span>           <span class="co"># tensor([ 3.])</span>
<span class="co">#&gt; tensor(3.)</span></pre></div>
<div class="sourceCode" id="cb92"><pre class="downlit">
<span class="co"># convert it to a scalar value</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">new_tensor</span><span class="op">[</span><span class="fl">2L</span>, <span class="fl">1L</span><span class="op">]</span><span class="op">$</span><span class="fu">item</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>    <span class="co"># 3.</span>
<span class="co">#&gt; [1] 3</span></pre></div>
<div class="sourceCode" id="cb93"><pre class="downlit">
<span class="co"># which is the same as</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">new_tensor</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; tensor(3.)</span></pre></div>
<div class="sourceCode" id="cb94"><pre class="downlit">
<span class="co"># and the scalar</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">new_tensor</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="fu">item</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt; [1] 3</span></pre></div>
</div>
<div id="extract-part-of-a-tensor" class="section level3">
<h3 class="hasAnchor">
<a href="#extract-part-of-a-tensor" class="anchor"></a>Extract part of a tensor</h3>
<div class="sourceCode" id="cb95"><pre class="downlit">
<span class="co"># Select indices</span>
<span class="va">x</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">randn</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">4L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; tensor([[-2.4324,  0.5563,  1.3308, -0.6363],</span>
<span class="co">#&gt;         [ 1.1925,  2.4744, -0.0463, -2.2281],</span>
<span class="co">#&gt;         [-1.5476,  1.1377,  0.3645, -0.8908]])</span></pre></div>
<div class="sourceCode" id="cb96"><pre class="downlit">
<span class="co"># extract first and third row</span>
<span class="co"># Select indices, dim=0</span>
<span class="va">indices</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">index_select</span><span class="op">(</span><span class="va">x</span>, <span class="fl">0L</span>, <span class="va">indices</span><span class="op">)</span>
<span class="co">#&gt; tensor([[-2.4324,  0.5563,  1.3308, -0.6363],</span>
<span class="co">#&gt;         [-1.5476,  1.1377,  0.3645, -0.8908]])</span></pre></div>
<div class="sourceCode" id="cb97"><pre class="downlit">
<span class="co"># extract first and third column</span>
<span class="co"># Select indices, dim=1</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">index_select</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1L</span>, <span class="va">indices</span><span class="op">)</span>
<span class="co">#&gt; tensor([[-2.4324,  1.3308],</span>
<span class="co">#&gt;         [ 1.1925, -0.0463],</span>
<span class="co">#&gt;         [-1.5476,  0.3645]])</span></pre></div>
<div class="sourceCode" id="cb98"><pre class="downlit">
<span class="co"># Take by indices</span>
<span class="va">src</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,
                        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">src</span><span class="op">)</span>
<span class="co">#&gt; tensor([[4., 3., 5.],</span>
<span class="co">#&gt;         [6., 7., 8.]])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span> <span class="va">torch</span><span class="op">$</span><span class="fu">take</span><span class="op">(</span><span class="va">src</span>, <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">2L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
<span class="co">#&gt; tensor([4., 5., 8.])</span></pre></div>
</div>
</div>
<div id="tensor-operations" class="section level2">
<h2 class="hasAnchor">
<a href="#tensor-operations" class="anchor"></a>Tensor operations</h2>
<div id="transpose" class="section level3">
<h3 class="hasAnchor">
<a href="#transpose" class="anchor"></a>Transpose</h3>
<div class="sourceCode" id="cb99"><pre class="downlit">
<span class="co"># two dimensions: 3x3</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">9L</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="va">x</span>, <span class="fl">0L</span>, <span class="fl">1L</span><span class="op">)</span>

<span class="va">x</span>   <span class="co"># "Original tensor"</span>
<span class="co">#&gt; tensor([[0, 1, 2],</span>
<span class="co">#&gt;         [3, 4, 5],</span>
<span class="co">#&gt;         [6, 7, 8]])</span>

<span class="va">t</span>    <span class="co"># "Transposed"</span>
<span class="co">#&gt; tensor([[0, 3, 6],</span>
<span class="co">#&gt;         [1, 4, 7],</span>
<span class="co">#&gt;         [2, 5, 8]])</span></pre></div>
<div class="sourceCode" id="cb100"><pre class="downlit">
<span class="co"># three dimensions: 1x2x3</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1L</span>, <span class="fl">0L</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>     <span class="co"># original tensor</span>
<span class="co">#&gt; tensor([[[1., 1., 1.],</span>
<span class="co">#&gt;          [1., 1., 1.]]])</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>     <span class="co"># transposed</span>
<span class="co">#&gt; tensor([[[1., 1., 1.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[1., 1., 1.]]])</span>


<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span>    <span class="co"># original tensor</span>
<span class="co">#&gt; torch.Size([1, 2, 3])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">t</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span>    <span class="co"># transposed</span>
<span class="co">#&gt; torch.Size([2, 1, 3])</span></pre></div>
</div>
<div id="permutation" class="section level3">
<h3 class="hasAnchor">
<a href="#permutation" class="anchor"></a>Permutation</h3>
</div>
<div id="permute-a-2d-tensor" class="section level3">
<h3 class="hasAnchor">
<a href="#permute-a-2d-tensor" class="anchor"></a>permute a 2D tensor</h3>
<div class="sourceCode" id="cb101"><pre class="downlit">
<span class="va">x</span>   <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">xs</span>  <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">as_tensor</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span>
<span class="va">xp</span>  <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="fu">permute</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">0L</span><span class="op">)</span><span class="op">)</span>
<span class="va">xps</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">as_tensor</span><span class="op">(</span><span class="va">xp</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>     <span class="co"># original tensor</span>
<span class="co">#&gt; tensor([[[1., 2.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[3., 4.]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[5., 6.]]])</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">xp</span><span class="op">)</span>    <span class="co"># permuted tensor</span>
<span class="co">#&gt; tensor([[[1., 3., 5.],</span>
<span class="co">#&gt;          [2., 4., 6.]]])</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">xs</span><span class="op">)</span>     <span class="co"># shape original tensor</span>
<span class="co">#&gt; tensor([3, 1, 2])</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">xps</span><span class="op">)</span>    <span class="co"># shape permuted tensor</span>
<span class="co">#&gt; tensor([1, 2, 3])</span></pre></div>
</div>
<div id="permute-a-3d-tensor" class="section level3">
<h3 class="hasAnchor">
<a href="#permute-a-3d-tensor" class="anchor"></a>permute a 3D tensor</h3>
<div class="sourceCode" id="cb102"><pre class="downlit">
<span class="va">torch</span><span class="op">$</span><span class="fu">manual_seed</span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="co">#&gt; &lt;torch._C.Generator&gt;</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">randn</span><span class="op">(</span><span class="fl">10L</span>, <span class="fl">480L</span>, <span class="fl">640L</span>, <span class="fl">3L</span><span class="op">)</span>
<span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; tensor([[[[-0.0883,  0.3420],</span>
<span class="co">#&gt;           [ 1.0051, -0.1117],</span>
<span class="co">#&gt;           [-0.0982, -0.3511]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          [[-0.1465,  0.3960],</span>
<span class="co">#&gt;           [-1.6878,  0.5720],</span>
<span class="co">#&gt;           [ 0.9426,  2.1187]]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[[ 0.8107,  0.9289],</span>
<span class="co">#&gt;           [ 0.4210, -1.5109],</span>
<span class="co">#&gt;           [-1.8483, -0.4636]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          [[-1.8324, -1.9304],</span>
<span class="co">#&gt;           [-2.7020,  0.3491],</span>
<span class="co">#&gt;           [ 0.9180, -1.9872]]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[[ 1.6555, -0.3531],</span>
<span class="co">#&gt;           [ 0.4763,  0.8037],</span>
<span class="co">#&gt;           [-0.2171, -0.0839]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          [[-0.0886, -1.3389],</span>
<span class="co">#&gt;           [ 0.7163, -0.9050],</span>
<span class="co">#&gt;           [-0.8144, -1.4922]]]])</span></pre></div>
<div class="sourceCode" id="cb103"><pre class="downlit">
<span class="va">xs</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">as_tensor</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>     <span class="co"># torch$tensor(c(10L, 480L, 640L, 3L))</span>
<span class="va">xp</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="fu">permute</span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">3L</span>, <span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span>     <span class="co"># specify dimensions order</span>
<span class="va">xps</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">as_tensor</span><span class="op">(</span><span class="va">xp</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>   <span class="co"># torch$tensor(c(10L, 3L, 480L, 640L))</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">xs</span><span class="op">)</span>      <span class="co"># original tensor size</span>
<span class="co">#&gt; tensor([ 10, 480, 640,   3])</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">xps</span><span class="op">)</span>     <span class="co"># permuted tensor size</span>
<span class="co">#&gt; tensor([ 10,   3, 480, 640])</span></pre></div>
<div class="sourceCode" id="cb104"><pre class="downlit">
<span class="va">xp</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; tensor([[[[-0.0883,  1.0051],</span>
<span class="co">#&gt;           [-0.1465, -1.6878],</span>
<span class="co">#&gt;           [-0.6429,  0.5577]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          [[ 0.3420, -0.1117],</span>
<span class="co">#&gt;           [ 0.3960,  0.5720],</span>
<span class="co">#&gt;           [ 0.3014,  0.7813]]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[[ 0.8107,  0.4210],</span>
<span class="co">#&gt;           [-1.8324, -2.7020],</span>
<span class="co">#&gt;           [ 1.1724,  0.4434]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          [[ 0.9289, -1.5109],</span>
<span class="co">#&gt;           [-1.9304,  0.3491],</span>
<span class="co">#&gt;           [ 0.9901, -1.3630]]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         [[[ 1.6555,  0.4763],</span>
<span class="co">#&gt;           [-0.0886,  0.7163],</span>
<span class="co">#&gt;           [-0.7774, -0.6281]],</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          [[-0.3531,  0.8037],</span>
<span class="co">#&gt;           [-1.3389, -0.9050],</span>
<span class="co">#&gt;           [-0.7920,  1.3634]]]])</span></pre></div>
</div>
</div>
<div id="logical-operations" class="section level2">
<h2 class="hasAnchor">
<a href="#logical-operations" class="anchor"></a>Logical operations</h2>
<div id="is-it-equal" class="section level3">
<h3 class="hasAnchor">
<a href="#is-it-equal" class="anchor"></a>is it equal</h3>
<div class="sourceCode" id="cb105"><pre class="downlit">
<span class="op">(</span><span class="va">m0</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">zeros</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[0., 0., 0., 0., 0.],</span>
<span class="co">#&gt;         [0., 0., 0., 0., 0.],</span>
<span class="co">#&gt;         [0., 0., 0., 0., 0.]])</span></pre></div>
<div class="sourceCode" id="cb106"><pre class="downlit">
<span class="op">(</span><span class="va">m1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[1., 1., 1., 1., 1.],</span>
<span class="co">#&gt;         [1., 1., 1., 1., 1.],</span>
<span class="co">#&gt;         [1., 1., 1., 1., 1.]])</span></pre></div>
<div class="sourceCode" id="cb107"><pre class="downlit">
<span class="op">(</span><span class="va">m2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">eye</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[1., 0., 0., 0., 0.],</span>
<span class="co">#&gt;         [0., 1., 0., 0., 0.],</span>
<span class="co">#&gt;         [0., 0., 1., 0., 0.]])</span></pre></div>
<div class="sourceCode" id="cb108"><pre class="downlit">
<span class="co"># is m1 equal to m0</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">m1</span> <span class="op">==</span> <span class="va">m0</span><span class="op">)</span>
<span class="co">#&gt; tensor([[False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False]])</span></pre></div>
<div class="sourceCode" id="cb109"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="reference/as_boolean.html">as_boolean</a></span><span class="op">(</span><span class="va">m1</span> <span class="op">==</span> <span class="va">m0</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False]])</span></pre></div>
</div>
<div id="is-it-not-equal" class="section level3">
<h3 class="hasAnchor">
<a href="#is-it-not-equal" class="anchor"></a>is it not equal</h3>
<div class="sourceCode" id="cb110"><pre class="downlit">
<span class="co"># is it not equal</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">m1</span> <span class="op">!=</span> <span class="va">m1</span><span class="op">)</span>
<span class="co">#&gt; tensor([[False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False]])</span></pre></div>
<div class="sourceCode" id="cb111"><pre class="downlit">
<span class="co"># are both equal</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">m2</span> <span class="op">==</span> <span class="va">m2</span><span class="op">)</span>
<span class="co">#&gt; tensor([[True, True, True, True, True],</span>
<span class="co">#&gt;         [True, True, True, True, True],</span>
<span class="co">#&gt;         [True, True, True, True, True]])</span></pre></div>
<div class="sourceCode" id="cb112"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="reference/as_boolean.html">as_boolean</a></span><span class="op">(</span><span class="va">m2</span> <span class="op">==</span> <span class="va">m2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[True, True, True, True, True],</span>
<span class="co">#&gt;         [True, True, True, True, True],</span>
<span class="co">#&gt;         [True, True, True, True, True]])</span></pre></div>
<div class="sourceCode" id="cb113"><pre class="downlit">
<span class="co"># some are equal, others don't</span>
<span class="va">m1</span> <span class="op">!=</span> <span class="va">m2</span>
<span class="co">#&gt; tensor([[False,  True,  True,  True,  True],</span>
<span class="co">#&gt;         [ True, False,  True,  True,  True],</span>
<span class="co">#&gt;         [ True,  True, False,  True,  True]])</span></pre></div>
<div class="sourceCode" id="cb114"><pre class="downlit">
<span class="co"># some are equal, others don't</span>
<span class="va">m0</span> <span class="op">!=</span> <span class="va">m2</span>
<span class="co">#&gt; tensor([[ True, False, False, False, False],</span>
<span class="co">#&gt;         [False,  True, False, False, False],</span>
<span class="co">#&gt;         [False, False,  True, False, False]])</span></pre></div>
<div class="sourceCode" id="cb115"><pre class="downlit">
<span class="fu"><a href="reference/as_boolean.html">as_boolean</a></span><span class="op">(</span><span class="va">m0</span> <span class="op">!=</span> <span class="va">m2</span><span class="op">)</span>
<span class="co">#&gt; tensor([[ True, False, False, False, False],</span>
<span class="co">#&gt;         [False,  True, False, False, False],</span>
<span class="co">#&gt;         [False, False,  True, False, False]])</span></pre></div>
</div>
<div id="and" class="section level3">
<h3 class="hasAnchor">
<a href="#and" class="anchor"></a>AND</h3>
<div class="sourceCode" id="cb116"><pre class="downlit">
<span class="co"># AND</span>
<span class="va">m1</span> <span class="op">&amp;</span> <span class="va">m1</span>
<span class="co">#&gt; tensor([[1, 1, 1, 1, 1],</span>
<span class="co">#&gt;         [1, 1, 1, 1, 1],</span>
<span class="co">#&gt;         [1, 1, 1, 1, 1]], dtype=torch.uint8)</span></pre></div>
<div class="sourceCode" id="cb117"><pre class="downlit">
<span class="fu"><a href="reference/as_boolean.html">as_boolean</a></span><span class="op">(</span><span class="va">m1</span> <span class="op">&amp;</span> <span class="va">m1</span><span class="op">)</span>
<span class="co">#&gt; tensor([[True, True, True, True, True],</span>
<span class="co">#&gt;         [True, True, True, True, True],</span>
<span class="co">#&gt;         [True, True, True, True, True]])</span></pre></div>
</div>
<div id="or" class="section level3">
<h3 class="hasAnchor">
<a href="#or" class="anchor"></a>OR</h3>
<div class="sourceCode" id="cb118"><pre class="downlit">
<span class="co"># OR</span>
<span class="va">m0</span> <span class="op">|</span> <span class="va">m2</span>
<span class="co">#&gt; tensor([[1, 0, 0, 0, 0],</span>
<span class="co">#&gt;         [0, 1, 0, 0, 0],</span>
<span class="co">#&gt;         [0, 0, 1, 0, 0]], dtype=torch.uint8)</span></pre></div>
<div class="sourceCode" id="cb119"><pre class="downlit">
<span class="co"># OR</span>
<span class="va">m1</span> <span class="op">|</span> <span class="va">m2</span>
<span class="co">#&gt; tensor([[1, 1, 1, 1, 1],</span>
<span class="co">#&gt;         [1, 1, 1, 1, 1],</span>
<span class="co">#&gt;         [1, 1, 1, 1, 1]], dtype=torch.uint8)</span></pre></div>
<div class="sourceCode" id="cb120"><pre class="downlit">
<span class="fu"><a href="reference/as_boolean.html">as_boolean</a></span><span class="op">(</span><span class="va">m1</span> <span class="op">|</span> <span class="va">m2</span><span class="op">)</span>
<span class="co">#&gt; tensor([[True, True, True, True, True],</span>
<span class="co">#&gt;         [True, True, True, True, True],</span>
<span class="co">#&gt;         [True, True, True, True, True]])</span></pre></div>
</div>
<div id="extract-only-one-logical-result-with-all" class="section level3">
<h3 class="hasAnchor">
<a href="#extract-only-one-logical-result-with-all" class="anchor"></a>Extract only one logical result with <em>all</em>
</h3>
<div class="sourceCode" id="cb121"><pre class="downlit">
<span class="co"># tensor is less than</span>
<span class="va">A</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">60000L</span>, <span class="fl">1L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span>
<span class="va">C</span> <span class="op">&lt;-</span> <span class="va">A</span> <span class="op">*</span> <span class="fl">0.5</span>

<span class="co"># is C &lt; A = TRUE</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">lt</span><span class="op">(</span><span class="va">C</span>, <span class="va">A</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">C</span> <span class="op">&lt;</span> <span class="va">A</span><span class="op">)</span> 
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>
<span class="co"># is A &lt; C = FALSE</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">A</span> <span class="op">&lt;</span> <span class="va">C</span><span class="op">)</span>
<span class="co">#&gt; tensor(0, dtype=torch.uint8)</span></pre></div>
</div>
<div id="greater-than" class="section level3">
<h3 class="hasAnchor">
<a href="#greater-than" class="anchor"></a>greater than</h3>
<div class="sourceCode" id="cb122"><pre class="downlit">
<span class="co"># tensor is greater than</span>
<span class="va">A</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">60000L</span>, <span class="fl">1L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span>
<span class="va">D</span> <span class="op">&lt;-</span> <span class="va">A</span> <span class="op">*</span> <span class="fl">2.0</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="va">D</span>, <span class="va">A</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="va">A</span>, <span class="va">D</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(0, dtype=torch.uint8)</span></pre></div>
</div>
<div id="lower-than" class="section level3">
<h3 class="hasAnchor">
<a href="#lower-than" class="anchor"></a>lower than</h3>
<div class="sourceCode" id="cb123"><pre class="downlit">
<span class="co"># tensor is less than or equal</span>
<span class="va">A1</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">60000L</span>, <span class="fl">1L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">le</span><span class="op">(</span><span class="va">A1</span>, <span class="va">A1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">A1</span> <span class="op">&lt;=</span> <span class="va">A1</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>

<span class="co"># tensor is greater than or equal</span>
<span class="va">A0</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">zeros</span><span class="op">(</span><span class="fl">60000L</span>, <span class="fl">1L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">ge</span><span class="op">(</span><span class="va">A0</span>, <span class="va">A0</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">A0</span> <span class="op">&gt;=</span> <span class="va">A0</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>

<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">A1</span> <span class="op">&gt;=</span> <span class="va">A0</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">A1</span> <span class="op">&lt;=</span> <span class="va">A0</span><span class="op">)</span>
<span class="co">#&gt; tensor(0, dtype=torch.uint8)</span></pre></div>
</div>
<div id="as-a-r-logical-value" class="section level3">
<h3 class="hasAnchor">
<a href="#as-a-r-logical-value" class="anchor"></a>As a R logical value</h3>
<div class="sourceCode" id="cb124"><pre class="downlit">
<span class="co"># we implement this little function</span>
<span class="va">all_as_boolean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># convert tensor of 1s and 0s to a unique boolean</span>
  <span class="fu"><a href="https://rdrr.io/r/base/logical.html">as.logical</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">all</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></pre></div>
<div class="sourceCode" id="cb125"><pre class="downlit">
<span class="fu">all_as_boolean</span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="va">D</span>, <span class="va">A</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="fu">all_as_boolean</span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="va">A</span>, <span class="va">D</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="fu">all_as_boolean</span><span class="op">(</span><span class="va">A1</span> <span class="op">&lt;=</span> <span class="va">A1</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="fu">all_as_boolean</span><span class="op">(</span><span class="va">A1</span> <span class="op">&gt;=</span> <span class="va">A0</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="fu">all_as_boolean</span><span class="op">(</span><span class="va">A1</span> <span class="op">&lt;=</span> <span class="va">A0</span><span class="op">)</span>
<span class="co">#&gt; [1] FALSE</span></pre></div>
</div>
<div id="logical-not" class="section level3">
<h3 class="hasAnchor">
<a href="#logical-not" class="anchor"></a>Logical NOT</h3>
<div class="sourceCode" id="cb126"><pre class="downlit">
<span class="co"># vector of booleans</span>
<span class="va">all_true</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">BoolTensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">all_true</span>
<span class="co">#&gt; tensor([True, True, True, True])</span></pre></div>
<div class="sourceCode" id="cb127"><pre class="downlit">
<span class="co"># logical NOT</span>
<span class="co"># negate vector with "!"</span>
<span class="va">not_all_true</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">all_true</span>
<span class="va">not_all_true</span>
<span class="co">#&gt; tensor([False, False, False, False])</span></pre></div>
<div class="sourceCode" id="cb128"><pre class="downlit">
<span class="co"># a diagonal matrix</span>
<span class="va">diag</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">eye</span><span class="op">(</span><span class="fl">5L</span><span class="op">)</span>
<span class="va">diag</span> <span class="op">&lt;-</span> <span class="va">diag</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span>dtype<span class="op">=</span><span class="va">torch</span><span class="op">$</span><span class="va">uint8</span><span class="op">)</span>   <span class="co"># convert to unsigned integer</span>
<span class="va">diag</span>
<span class="co">#&gt; tensor([[1, 0, 0, 0, 0],</span>
<span class="co">#&gt;         [0, 1, 0, 0, 0],</span>
<span class="co">#&gt;         [0, 0, 1, 0, 0],</span>
<span class="co">#&gt;         [0, 0, 0, 1, 0],</span>
<span class="co">#&gt;         [0, 0, 0, 0, 1]], dtype=torch.uint8)</span></pre></div>
<div class="sourceCode" id="cb129"><pre class="downlit">
<span class="fu"><a href="reference/as_boolean.html">as_boolean</a></span><span class="op">(</span><span class="va">diag</span><span class="op">)</span>
<span class="co">#&gt; tensor([[ True, False, False, False, False],</span>
<span class="co">#&gt;         [False,  True, False, False, False],</span>
<span class="co">#&gt;         [False, False,  True, False, False],</span>
<span class="co">#&gt;         [False, False, False,  True, False],</span>
<span class="co">#&gt;         [False, False, False, False,  True]])</span></pre></div>
<div class="sourceCode" id="cb130"><pre class="downlit">
<span class="co"># logical NOT</span>
<span class="va">not_diag</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">diag</span>
<span class="va">not_diag</span>
<span class="co">#&gt; tensor([[0, 1, 1, 1, 1],</span>
<span class="co">#&gt;         [1, 0, 1, 1, 1],</span>
<span class="co">#&gt;         [1, 1, 0, 1, 1],</span>
<span class="co">#&gt;         [1, 1, 1, 0, 1],</span>
<span class="co">#&gt;         [1, 1, 1, 1, 0]], dtype=torch.uint8)</span></pre></div>
<div class="sourceCode" id="cb131"><pre class="downlit">
<span class="co"># and the negation</span>
<span class="op">!</span><span class="va">not_diag</span>
<span class="co">#&gt; tensor([[1, 0, 0, 0, 0],</span>
<span class="co">#&gt;         [0, 1, 0, 0, 0],</span>
<span class="co">#&gt;         [0, 0, 1, 0, 0],</span>
<span class="co">#&gt;         [0, 0, 0, 1, 0],</span>
<span class="co">#&gt;         [0, 0, 0, 0, 1]], dtype=torch.uint8)</span></pre></div>
<div class="sourceCode" id="cb132"><pre class="downlit">
<span class="fu"><a href="reference/as_boolean.html">as_boolean</a></span><span class="op">(</span><span class="op">!</span><span class="va">not_diag</span><span class="op">)</span>
<span class="co">#&gt; tensor([[ True, False, False, False, False],</span>
<span class="co">#&gt;         [False,  True, False, False, False],</span>
<span class="co">#&gt;         [False, False,  True, False, False],</span>
<span class="co">#&gt;         [False, False, False,  True, False],</span>
<span class="co">#&gt;         [False, False, False, False,  True]])</span></pre></div>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=rTorch">https://â€‹cloud.r-project.org/â€‹package=rTorch</a>
</li>
<li>Browse source code at <br><a href="https://github.com/f0nzie/rTorch/">https://â€‹github.com/â€‹f0nzie/â€‹rTorch/â€‹</a>
</li>
<li>Report a bug at <br><a href="https://github.com/f0nzie/rTorch/issues">https://â€‹github.com/â€‹f0nzie/â€‹rTorch/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Alfonso R. Reyes <br><small class="roles"> Author, maintainer, copyright holder </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/f0nzie/rTorch"><img src="https://travis-ci.org/f0nzie/rTorch.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://ci.appveyor.com/project/f0nzie/rTorch"><img src="https://ci.appveyor.com/api/projects/status/github/f0nzie/rTorch?branch=master&amp;svg=true" alt="AppVeyor build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Alfonso R. Reyes.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
